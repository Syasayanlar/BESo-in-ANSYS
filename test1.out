
 ANSYS Mechanical Enterprise                       


 *------------------------------------------------------------------*
 |                                                                  |
 |   W E L C O M E   T O   T H E   A N S Y S (R)  P R O G R A M     |
 |                                                                  |
 *------------------------------------------------------------------*




 ***************************************************************
 *            ANSYS 2019 R2          LEGAL NOTICES             *
 ***************************************************************
 *                                                             *
 * Copyright 1971-2019 ANSYS, Inc.  All rights reserved.       *
 * Unauthorized use, distribution or duplication is            *
 * prohibited.                                                 *
 *                                                             *
 * Ansys is a registered trademark of ANSYS, Inc. or its       *
 * subsidiaries in the United States or other countries.       *
 * See the ANSYS, Inc. online documentation or the ANSYS, Inc. *
 * documentation CD or online help for the complete Legal      *
 * Notice.                                                     *
 *                                                             *
 ***************************************************************
 *                                                             *
 * THIS ANSYS SOFTWARE PRODUCT AND PROGRAM DOCUMENTATION       *
 * INCLUDE TRADE SECRETS AND CONFIDENTIAL AND PROPRIETARY      *
 * PRODUCTS OF ANSYS, INC., ITS SUBSIDIARIES, OR LICENSORS.    *
 * The software products and documentation are furnished by    *
 * ANSYS, Inc. or its subsidiaries under a software license    *
 * agreement that contains provisions concerning               *
 * non-disclosure, copying, length and nature of use,          *
 * compliance with exporting laws, warranties, disclaimers,    *
 * limitations of liability, and remedies, and other           *
 * provisions.  The software products and documentation may be *
 * used, disclosed, transferred, or copied only in accordance  *
 * with the terms and conditions of that software license      *
 * agreement.                                                  *
 *                                                             *
 * ANSYS, Inc. is a UL registered                              *
 * ISO 9001:2015 company.                                      *
 *                                                             *
 ***************************************************************
 *                                                             *
 * This product is subject to U.S. laws governing export and   *
 * re-export.                                                  *
 *                                                             *
 * For U.S. Government users, except as specifically granted   *
 * by the ANSYS, Inc. software license agreement, the use,     *
 * duplication, or disclosure by the United States Government  *
 * is subject to restrictions stated in the ANSYS, Inc.        *
 * software license agreement and FAR 12.212 (for non-DOD      *
 * licenses).                                                  *
 *                                                             *
 ***************************************************************

 2019 R2 
     
 Point Releases and Patches installed:   
     
 ANSYS, Inc. Products 2019 R2
 SpaceClaim 2019 R2  
 AIM 2019 R2 
 Live (includes SpaceClaim) 2019 R2  
 Autodyn 2019 R2 
 LS-DYNA 2019 R2 
 Customization Files for User Programmable Features 2019 R2  
 Mechanical Products 2019 R2 
 Additive 2019 R2
 ACIS Geometry Interface 2019 R2 
 AutoCAD Geometry Interface 2019 R2  
 Catia, Version 4 Geometry Interface 2019 R2 
 Catia, Version 6 Geometry Interface 2019 R2 
 Creo Elements/Direct Modeling Geometry Interface 2019 R2
 Creo Parametric Geometry Interface 2019 R2  
 Inventor Geometry Interface 2019 R2 
 JTOpen Geometry Interface 2019 R2   
 NX Geometry Interface 2019 R2   
 Parasolid Geometry Interface  2019 R2   
 Solid Edge Geometry Interface 2019 R2   
 SOLIDWORKS Geometry Interface 2019 R2   
 ANSYS, Inc. License Manager 2019 R2 


          *****  ANSYS COMMAND LINE ARGUMENTS  *****
  INITIAL JOBNAME              = BESO_APPLICATION                                                                                                                                                                                                                                        
  BATCH MODE REQUESTED (-b)    = LIST
  INPUT FILE COPY MODE (-c)    = COPY
  DISTRIBUTED MEMORY PARALLEL REQUESTED
      12 PARALLEL PROCESSES REQUESTED WITH SINGLE THREAD PER PROCESS
    TOTAL OF    12 CORES REQUESTED
  MPI OPTION                   = INTELMPI
  INPUT FILE NAME              = C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\beso_2020.in
  OUTPUT FILE NAME             = C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\test1.out
  START-UP FILE MODE           = READ  
  STOP FILE MODE               = READ  
  LANGUAGE                     = en-us               
  INITIAL DIRECTORY = C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS

 RELEASE= 2019 R2              BUILD= 19.4      UP20190416   VERSION=WINDOWS x64 
 CURRENT JOBNAME=BESO_APPLICATION0  23:19:22  JAN 11, 2026 CP=      0.188

     1  ! ========================================================================  
     2  ! ANSYS APDL Code for BESO with Dual P-Norm Aggregation 
     3  ! Augmented Lagrangian Optimization 
     4  ! ========================================================================  
     5  ! Features: 
     6  ! - Analytical compliance sensitivity   
     7  ! - P-norm aggregated stress constraint with analytical sensitivity 
     8  ! - P-norm aggregated displacement constraint with analytical sensitivity   
     9  ! - All constraints active from iteration 1 
    10  ! - Volume, stress, and displacement constraints
    11  ! - Design/Passive domain management
    12  ! - FULLY ANALYTICAL - NO NUMERICAL DIFFERENTIATION 
    13  ! ========================================================================  
    14  !   
    15  ! P-NORM AGGREGATION METHOD - THEORETICAL BACKGROUND
    16  ! ===================================================   
    17  !   
    18  ! The p-norm aggregation provides a smooth, differentiable approximation
    19  ! to maximum constraints, enabling efficient analytical sensitivity 
    20  ! computation without expensive numerical differentiation.  
    21  !   
    22  ! STRESS FORMULATION:   
    23  ! -------------------   
    24  ! Instead of max(σ_i) ≤ σ_limit, we use:
    25  !   σ_pnorm = σ_ref × (Σ(σ_i/σ_ref)^p)^(1/p) ≤ σ_limit 
    26  !   
    27  ! DISPLACEMENT FORMULATION: 
    28  ! ------------------------- 
    29  ! Instead of max(d_i) ≤ d_limit, we use:  
    30  !   d_pnorm = d_ref × (Σ(d_i/d_ref)^p)^(1/p) ≤ d_limit  
    31  ! where d_i = √(ux² + uy² + uz²) at each node  
    32  !   
    33  ! PROPERTIES:   
    34  ! -----------   
    35  ! • As p → ∞, p-norm → exact maximum
    36  ! • For stress: p = 8 typical (sharp local peaks) 
    37  ! • For displacement: p = 6 typical (smoother field distribution) 
    38  ! • Higher p = tighter bound but steeper gradients
    39  ! • Lower p = smoother but looser bound   
    40  !   
    41  ! ANALYTICAL SENSITIVITIES: 
    42  ! ------------------------- 
    43  ! Stress: ∂σ_pnorm/∂x_i = (σ_i/σ_pnorm)^(p-1) × (σ_ref/σ_pnorm) × ∂σ_i/∂x_i 
    44  ! Displ:  ∂d_pnorm/∂x_e = Σ_nodes[(d_j/d_pnorm)^(p-1) × (d_ref/d_pnorm) × ∂d_j/∂x_e] 
    45  !   
    46  ! COMPUTATIONAL EFFICIENCY: 
    47  ! ------------------------- 
    48  ! Numerical differentiation:  2N FEA solves per iteration (stress + displ)  
    49  ! Dual P-norm aggregation:    1 FEA solve per iteration 
    50  ! Speedup factor:             ~2N (e.g., 3000× for N=1500 elements)
    51  !   
    52  ! REFERENCES:   
    53  ! -----------   
    54  ! 1. Kennedy, G.J. & Hicken, J.E. (2015)
    55  !    "Improved constraint-aggregation methods"  
    56  !    Computer Methods in Applied Mechanics and Engineering, 289, 332-354
    57  !    DOI: 10.1016/j.cma.2015.02.017 
    58  !   
    59  ! 2. Le, C., Norato, J., Bruns, T., Ha, C., & Tortorelli, D. (2010) 
    60  !    "Stress-based topology optimization for continua"  
    61  !    Structural and Multidisciplinary Optimization, 41(4), 605-620  
    62  !    DOI: 10.1007/s00158-009-0424-y 
    63  !   
    64  ! 3. París, J., Navarrina, F., Colominas, I., & Casteleiro, M. (2009)  
    65  !    "Topology optimization of continuum structures with local and  
    66  !     global stress constraints"
    67  !    Structural and Multidisciplinary Optimization, 39(4), 419-437  
    68  !    DOI: 10.1007/s00158-008-0336-2 
    69  !   
    70  ! 4. Holmberg, E., Torstenfelt, B., & Klarbring, A. (2013)  
    71  !    "Stress constrained topology optimization" 
    72  !    Structural and Multidisciplinary Optimization, 48(1), 33-47
    73  !    DOI: 10.1007/s00158-012-0880-7 
    74  !   
    75  ! 5. da Silva, G.A., Beck, A.T., & Sigmund, O. (2019)   
    76  !    "Stress-constrained topology optimization considering uniform  
    77  !     manufacturing uncertainties"  
    78  !    Computer Methods in Applied Mechanics and Engineering, 344, 512-537
    79  !    DOI: 10.1016/j.cma.2018.10.020 
    80  !   
    81  ! 6. Kreisselmeier, G. & Steinhauser, R. (1979) 
    82  !    "Systematic Control Design by Optimizing a Vector Performance Index"   
    83  !    IFAC Symposium on Computer Aided Design of Control Systems 
    84  !   
    85  ! ========================================================================  
    86  /BATCH  
    87  FINISH  
    88  /CLEAR, NOSTART 
    89      
    90  /FILENAME, beso_2020, 1 
    91  /COM, BESO Topology Optimization with Augmented Lagrange for Volume, Stress and Displacement Constraints
    92  /COM, Modified by Suleyman Yasayanlar 2026  
    93  /COM, Be aware of units used in the model (N, mm)   
    94  /COM, Be aware of material numbers for design and passive domains   
    95  /COM, Material 1 : Design Material  
    96  /COM, Material 2 : Void Material
    97  /COM, If submodel please add cut BCs in Section 3   
    98      
    99  /COM, Clear all previous data   
   100  ! Delete old result files   
   101  /SYS, del *.esav
   102  /SYS, del *.full
   103  /SYS, del *.mntr
   104  /SYS, del *.page
   105  /SYS, del *.rst 
   106  /SYS, del *.stat
   107  /SYS, del *.db  
   108  /SYS, del *.lock
   109  ! ========================================================================  
   110  ! SECTION 1: INPUT PARAMETERS   
   111  !  MATERIAL PROPERTIES, MESH SIZE, BESO PARAMETERS  
   112  ! ========================================================================  
   113  ! ---   Constants   --- 
   114  _PI = acos(-1)  
   115  eps_machine = 1E-16            ! Machine epsilon for numerical differentiation  
   116      
   117  ! --- Material Properties ---   
   118  E_design       = 200e3               ! Young's Modulus (MPa)
   119  nu_design      = 0.3                 ! Poisson's Ratio  
   120  void_param     = 1e-9                ! Void material parameter  
   121  E_void         = void_param*E_design       ! Void Young's Modulus (MPa) 
   122  nu_void        = nu_design           ! Void Poisson's Ratio 
   123      
   124  ! --- Mesh Parameters ---   
   125  /COM, Element size and filter radius must be double checked with FEA model  
   126  esize_ = 20                     ! Element size (mm) 
   127  Rmin  = esize_*2.5              ! Filter radius for sensitivity smoothing   
   128      
   129  ! --- BESO Parameters ---   
   130  volfrac = 0.25                 ! Target volume fraction (25%)   
   131  ER      = 0.15                 ! Evolution rate (15% per iteration) 
   132  maxIter = 100                  ! Maximum number of iterations   
   133  convTol = 0.002                ! Convergence tolerance (0.2%)   
   134  conv_window = 5                ! Convergence window (iterations)
   135  xmin    = 0.001                ! Minimum density to avoid singularity   
   136      
   137  ! --- Constraint Parameters --- 
   138  stress_limit = 420             ! Maximum allowable von Mises stress (Pa) = 420 MPa  
   139  displ_limit_RMS = 50           ! RMS displacement limit (mm)
   140  tol_constraint = 0.05          ! Constraint tolerance (5% violation acceptable) 
   141      
   142  ! --- P-Norm Aggregation Parameters --- 
   143  p_norm_stress = 8.0            ! P-norm for stress (recommended: 6-12)  
   144                                 ! p=6:  smoother, ~15-20% error  
   145                                 ! p=8:  balanced, ~5-10% error (RECOMMENDED) 
   146                                 ! p=10: tighter, ~2-5% error 
   147                                 ! p=12: very tight, ~1-3% error (may be stiff)   
   148      
   149  p_norm_displ = 6.0             ! P-norm for displacement (recommended: 4-8) 
   150                                 ! Lower p for displacement (smoother field)  
   151                                 ! p=4:  very smooth, ~20-30% error   
   152                                 ! p=6:  balanced (RECOMMENDED)   
   153                                 ! p=8:  tight, ~5-10% error  
   154      
   155  sigma_ref = stress_limit       ! Reference stress for normalization 
   156  displ_ref = displ_limit_RMS    ! Reference displacement for normalization   
   157      
   158  ! --- Augmented Lagrangian Parameters ---   
   159  lambda_stress = 0              ! Stress constraint multiplier   
   160  lambda_displ = 0               ! Displacement constraint multiplier 
   161      
   162  mu_stress = 1E-8               ! Stress penalty parameter   
   163  mu_displ = 1E-8                ! Displacement penalty parameter 
   164  mu_max = 1E-4                  ! Maximum penalty parameter  
   165  mu_update = 10                 ! Penalty update factor  
   166  lambda_update = 0.5            ! Lagrange multiplier update rate
   167      
   168  ! --- LCF (Low Cycle Fatigue) Constraint Parameters (COMMENTED OUT - TO BE IMPLEMENTED) --- 
   169  ! lcf_cycles_min = 1000         ! Minimum required LCF life (cycles)
   170  ! p_norm_lcf = 6.0              ! P-norm for LCF aggregation (recommended: 4-8) 
   171  ! lambda_lcf = 0                ! LCF constraint multiplier 
   172  ! mu_lcf = 1E-8                 ! LCF penalty parameter 
   173  ! stress_mean = 0               ! Mean stress for LCF calculation (MPa) 
   174  ! stress_amplitude_ref = 200E6  ! Reference stress amplitude (Pa)   
   175  ! temperature = 293             ! Operating temperature (K) for LCF 
   176  ! material_b = -0.12            ! Fatigue strength exponent (typical for steel) 
   177  ! material_c = -0.6             ! Fatigue ductility exponent (typical for steel)
   178  ! material_Sf_prime = 1000E6    ! Fatigue strength coefficient (Pa) 
   179  ! material_Ef_prime = 0.5       ! Fatigue ductility coefficient 
   180  !   
   181  ! LCF FORMULATION:  
   182  ! ----------------  
   183  ! Basquin-Coffin-Manson equation:   
   184  !   Δε/2 = (σ'_f/E)(2N)^b + ε'_f(2N)^c  
   185  !   
   186  ! P-norm aggregation for minimum life:  
   187  !   N_pnorm = N_ref × (Σ(N_ref/N_i)^p)^(1/p)  
   188  !   Constraint: N_pnorm ≥ N_min   
   189  !   
   190  ! REFERENCES:   
   191  !   - Suresh, S. (1998). "Fatigue of Materials" Cambridge University Press  
   192  !   - Dowling, N.E. (2012). "Mechanical Behavior of Materials" Pearson  
   193  !   - Holmen, J.K. et al. (2017). "Topology optimization with fatigue   
   194  !     constraints" Structural and Multidisciplinary Optimization, 56(5) 
   195      
   196  /COM, ========================================================================  
   197  /PREP7  
   198  ! --- Define Material ---   
   199  ! material 1 : Design Material  
   200  ! material 2 : Void Material
   201  MPTEMP,,,,,,,,  
   202  MPTEMP,1,0  
   203  MPDATA,EX,1,,E_design   
   204  MPDATA,PRXY,1,,nu_design
   205      
   206  MPTEMP,,,,,,,,  
   207  MPTEMP,1,0  
   208  MPDATA,EX,2,,E_void 
   209  MPDATA,PRXY,2,,nu_void  
   210      
   211  ALLSEL  
   212  FINISH  
   213  ! ========================================================================  
   214  ! SECTION 2: READ MODEL AND INITIAL MESH
   215  ! BE AWARE OF UNITS USED IN THE MODEL (N, mm)   
   216  ! GE case : IN and PSI  
   217  ! ========================================================================  
   218  /input, simple_block, cdb, '.'  
   219  /PREP7  
   220  ALLSEL  
   221      
   222  /COM, For initial study all numberings are reset
   223  NUMCMP,ALL  
   224      
   225  EPLOT   
   226  /title, Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)   
   227  FINISH  
   228      
   229  ! ========================================================================  
   230  ! SECTION 3: APPLY MATERIALS, BOUNDARY CONDITIONS AND LOADS 
   231  ! If this is a submodel this is location where you apply Cut BCs
   232  ! ========================================================================  
   233  ALLSEL  
   234  /PREP7  
   235  ! --- Assign Material to Elements ---   
   236  /COM, If you have other domains please assign materials accordingly 
   237  ESEL,ALL
   238  EMODIF,ALL,,MAT,1   
   239      
   240  ! --- Boundary Conditions ---   
   241  ! --- User must update these based on model --- 
   242  nsel,s,,,FIXED_BC   
   243  d,all,all,0 
   244      
   245  nsel,s,,,FORCE_BC   
   246  F,all,fz,-1e7/16      ! Total force of -1e7 N distributed over 16 nodes 
   247      
   248  ALLSEL  
   249  FINISH  
   250  ! ========================================================================  
   251  ! SECTION 4: INITIALIZE ARRAYS AND VARIABLES
   252  ! ========================================================================  
   253  /PREP7  
   254  ALLSEL  
   255      
   256  ! Get element and node counts   
   257  *GET, numElem, ELEM, 0, COUNT   
   258  *GET, numNode, NODE, 0, COUNT   
   259      
   260  ESEL,s,,,DESIGN_DOMAIN  
   261  *GET, numDesignElem, ELEM, 0, COUNT 
   262  ALLSEL  
   263      
   264  ESEL,s,,,PASSIVE_REGION 
   265  *GET, numPassiveElem, ELEM, 0, COUNT
   266  ALLSEL  
   267      
   268  /COM, ========================================  
   269  /COM, BESO WITH DUAL P-NORM AGGREGATION 
   270  /COM, Total Elements: %numElem% 
   271  /COM, Total Nodes: %numNode%
   272  /COM, Design Domain Elements: %numDesignElem%   
   273  /COM, Passive Region Elements: %numPassiveElem% 
   274  /COM, Units are N and mm
   275  /COM, For later cases we can use in and psi units   
   276  /COM, Volume Fraction Target: %volfrac% 
   277  /COM, Evolution Rate: %ER% per iteration
   278  /COM, Maximum Iterations: %maxIter% 
   279  /COM, Convergence Tolerance: %convTol%  
   280  /COM, P-Norm Stress: %p_norm_stress%
   281  /COM, P-Norm Displacement: %p_norm_displ%   
   282  /COM, Stress Limit: %stress_limit% MPa  
   283  /COM, Displacement Limit: %displ_limit_RMS% mm  
   284  /COM, ========================================  
   285      
   286  ! --- Element density and sensitivity arrays ---
   287  *DIM, xe, ARRAY, numElem
   288  *DIM, sensit_C, ARRAY, numElem              ! Compliance sensitivity
   289  *DIM, sensit_g_stress, ARRAY, numElem       ! P-norm stress sensitivity 
   290  *DIM, sensit_g_displ, ARRAY, numElem        ! P-norm displacement sensitivity   
   291  *DIM, sensit_combined, ARRAY, numElem   
   292  *DIM, sensit_filt, ARRAY, numElem   
   293  *DIM, sensit_old, ARRAY, numElem
   294      
   295  ! --- Element geometry arrays ---   
   296  *DIM, elemCenX, ARRAY, numElem  
   297  *DIM, elemCenY, ARRAY, numElem  
   298  *DIM, elemCenZ, ARRAY, numElem  
   299  *DIM, elemVol, ARRAY, numElem   
   300      
   301  ! --- Optimization history arrays ---   
   302  *DIM, compliance, ARRAY, maxIter
   303  *DIM, volHistory, ARRAY, maxIter
   304  *DIM, stressPnormHistory, ARRAY, maxIter    ! P-norm aggregated stress  
   305  *DIM, maxStressHistory, ARRAY, maxIter      ! Actual maximum (for comparison)   
   306  *DIM, displPnormHistory, ARRAY, maxIter     ! P-norm aggregated displacement
   307  *DIM, maxDisplHistory, ARRAY, maxIter       ! Actual maximum displacement   
   308      
   309  ! --- Augmented Lagrangian tracking --- 
   310  *DIM, lambdaStressHistory, ARRAY, maxIter   
   311  *DIM, lambdaDisplHistory, ARRAY, maxIter
   312  *DIM, muStressHistory, ARRAY, maxIter   
   313  *DIM, muDisplHistory, ARRAY, maxIter
   314  *DIM, g_stressHistory, ARRAY, maxIter   
   315  *DIM, g_displHistory, ARRAY, maxIter
   316  *DIM, g_volHistory, ARRAY, maxIter  
   317  *DIM, pnormErrorStress, ARRAY, maxIter      ! P-norm stress approximation error 
   318  *DIM, pnormErrorDispl, ARRAY, maxIter       ! P-norm displ approximation error  
   319      
   320  ! --- Constraint arrays --- 
   321  *DIM, elemStress, ARRAY, numElem
   322      
   323  ! --- LCF arrays (COMMENTED OUT - TO BE IMPLEMENTED) ---
   324  ! *DIM, elemLCF, ARRAY, numElem             ! LCF life (cycles) per element 
   325  ! *DIM, elemStressAmp, ARRAY, numElem       ! Stress amplitude per element  
   326  ! *DIM, sensit_g_lcf, ARRAY, numElem        ! LCF constraint sensitivity
   327  ! *DIM, lcfPnormHistory, ARRAY, maxIter     ! P-norm aggregated LCF life
   328  ! *DIM, minLCFHistory, ARRAY, maxIter       ! Minimum LCF life (for comparison) 
   329  ! *DIM, lambdaLCFHistory, ARRAY, maxIter    ! LCF multiplier history
   330  ! *DIM, muLCFHistory, ARRAY, maxIter        ! LCF penalty history   
   331  ! *DIM, g_lcfHistory, ARRAY, maxIter        ! LCF constraint violation  
   332  ! *DIM, pnormErrorLCF, ARRAY, maxIter       ! LCF p-norm approximation error
   333      
   334  ! --- Nodal displacement arrays --- 
   335  *DIM, nodeDispX, ARRAY, numNode 
   336  *DIM, nodeDispY, ARRAY, numNode 
   337  *DIM, nodeDispZ, ARRAY, numNode 
   338  *DIM, nodeDisplMag, ARRAY, numNode          ! Displacement magnitude per node   
   339      
   340  ! --- BC nodes flag --- 
   341  *DIM, isBCNode, ARRAY, numNode  
   342      
   343  ! --- Estimate max neighbors per element based on filter radius --- 
   344  numNeighIncrease = 100                          ! Safety buffer for neighbor count  
   345  maxNeighbors = NINT((4/3)*_PI*(Rmin/esize_)**3)*4 + numNeighIncrease
   346  maxNeighbors = maxNeighbors + numNeighIncrease  ! Ensure enough space   
   347  *DIM, neighCount, ARRAY, numElem                ! Number of neighbors for each element  
   348  *DIM, neighList, ARRAY, numElem, maxNeighbors   ! Neighbor element indices  
   349  *DIM, neighWeight, ARRAY, numElem, maxNeighbors ! Neighbor weights (cone filter)
   350      
   351  *DIM, isDesign, ARRAY, numElem     ! Design domain flag (1=design, 0=passive)   
   352      
   353  ! Initialize all elements as solid (xe = 1) 
   354  *VFILL, xe(1), RAMP, 1.0, 0 
   355      
   356  ! Store element centroids and volumes   
   357  ALLSEL  
   358  *VGET, elemCenX(1), ELEM, 1, CENT, X
   359  *VGET, elemCenY(1), ELEM, 1, CENT, Y
   360  *VGET, elemCenZ(1), ELEM, 1, CENT, Z
   361  *VGET, elemVol(1), ELEM, 1, GEOM           ! Element volume 
   362      
   363      
   364  ! ========================================================================  
   365  ! PRE-COMPUTE NEIGHBOR LIST FOR SENSITIVITY FILTER  
   366  ! ========================================================================  
   367  allsel  
   368  /COM, Pre-computing neighbor list for 3D filter...  
   369  *DO, i, 1, numElem  
   370      neighCount(i) = 0   
   371      
   372      ! Get center of current element 
   373      cx_i = elemCenX(i)  
   374      cy_i = elemCenY(i)  
   375      cz_i = elemCenZ(i)  
   376      
   377      ! Select nodes within filter radius using spatial queries   
   378      ALLSEL  
   379      NSEL, S, LOC, X, cx_i - Rmin, cx_i + Rmin   
   380      NSEL, R, LOC, Y, cy_i - Rmin, cy_i + Rmin   
   381      NSEL, R, LOC, Z, cz_i - Rmin, cz_i + Rmin   
   382      
   383      ! Select elements attached to these nodes   
   384      ESLN, S, 1  
   385      
   386      ! Get the count of selected elements
   387      *GET, numNeigh, ELEM, 0, COUNT  
   388      
   389      ! Loop over selected neighbor elements and calculate weights
   390      *IF, numNeigh, GT, 0, THEN  
   391          *GET, j, ELEM, 0, NUM, MIN  
   392      
   393          *DO, k, 1, numNeigh 
   394              ! Calculate 3D distance from current element to neighbor
   395              dx = elemCenX(j) - cx_i 
   396              dy = elemCenY(j) - cy_i 
   397              dz = elemCenZ(j) - cz_i 
   398              dist = SQRT(dx*dx + dy*dy + dz*dz)  
   399      
   400              ! If within filter radius, store neighbor and weight
   401              *IF, dist, LT, Rmin, THEN   
   402                  neighCount(i) = neighCount(i) + 1   
   403                  nc = neighCount(i)  
   404      
   405                  ! Store neighbor ID and weight (cone filter: w = Rmin - dist)   
   406                  neighList(i, nc) = j
   407                  neighWeight(i, nc) = Rmin - dist
   408      
   409                  ! Safety check: don't exceed array size 
   410                  *IF, nc, GE, maxNeighbors, THEN 
   411                      *EXIT   
   412                  *ENDIF  
   413              *ENDIF  
   414      
   415              ! Get next element in selection 
   416              *IF, k, LT, numNeigh, THEN  
   417                  *GET, j, ELEM, j, NXTH  
   418              *ENDIF  
   419          *ENDDO  
   420      *ENDIF  
   421      
   422      ! Progress indicator
   423      *IF, MOD(i, 500), EQ, 0, THEN   
   424          /COM, Processed element %i% of %numElem%
   425      *ENDIF  
   426  *ENDDO  
   427      
   428  ALLSEL  
   429  /COM, Neighbor list computed.   
   430      
   431  ! ========================================================================  
   432  ! SECTION 4.1: DEFINE DESIGN AND PASSIVE REGIONS
   433  ! ========================================================================  
   434  numDesignElem = 0                 ! Counter for design elements 
   435  numPassiveElem = 0                ! Counter for passive elements
   436      
   437  ! if isDesign(i) = 1 then element is in design domain   
   438  ! else in passive region
   439  ! Initialize all elements in design domain  
   440  *VFILL, isDesign(1), RAMP, 1.0, 0   
   441      
   442  ! update isDesign array based on geometry   
   443  ! here only change passive region near BC and load point
   444  ! be aware those must be defined in set.
   445  ! Passive element set: PASSIVE_REGION   
   446  esel,s,,,PASSIVE_REGION 
   447  *GET, numPassiveElem, ELEM, NUM, COUNT  
   448  *get, curr_elem, ELEM, 0, NUM, MIN  
   449      
   450  *DO, i, 1, numPassiveElem   
   451      isDesign(curr_elem) = 0 
   452      *GET, curr_elem, ELEM, curr_elem, NXTH  
   453      numPassiveElem = numPassiveElem + 1 
   454  *ENDDO  
   455      
   456  esel,s,,,DESIGN_DOMAIN  
   457  *GET, numDesignElem, ELEM, NUM, COUNT   
   458      
   459  /COM, ========================================  
   460  /COM, ELEMENT & NODE NUMBERS ARE RESET INITALLY 
   461  /COM, DOMAIN INFORMATION:   
   462  /COM, Total Elements: %numElem% 
   463  /COM, Design Elements: %numDesignElem%  
   464  /COM, Passive Elements: %numElem - numDesignElem%   
   465  /COM, ========================================  
   466      
   467  ! Create design element index list for fast iteration   
   468  *DIM, designElemIdx, ARRAY, numDesignElem   ! Indices of design elements
   469  idx = 0 
   470      
   471  esel,s,,,DESIGN_DOMAIN  
   472  *GET, n_el, ELEM, NUM, COUNT
   473  *get, curr_elem, ELEM, 0, NUM, MIN  
   474      
   475  *DO, i, 1, n_el 
   476      idx = idx + 1   
   477      designElemIdx(idx) = curr_elem  
   478      *GET, curr_elem, ELEM, curr_elem, NXTH  
   479  *ENDDO  
   480      
   481  ALLSEL  
   482      
   483  ! Initialize volume 
   484  totalVol   = numDesignElem  
   485  currentVol = numDesignElem  
   486      
   487  FINISH  
   488      
   489  /COM, ========================================================================  
   490  /COM, DESIGN SETUP COMPLETE. READY FOR OPTIMIZATION LOOP.   
   491  /COM, PLEASE CHECK BCs, LOADS, MATERIALS BEFORE PROCEEDING. 
   492  /COM, ELEMENTS IN DESIGN DOMAIN: %numDesignElem%
   493  /COM, ELEMENTS IN PASSIVE REGION: %numPassiveElem%  
   494  /COM, OPTIMIZATION WILL BE PERFORMED IN DESIGN_DOMAIN ONLY. 
   495  /COM, IF YOU WANT YOU CAN ALWAYS TWEAK OPTIMIZATION PARAMETERS IN beso_2020.in  
   496  /COM, ========================================================================  
   497      
   498  ! ========================================================================  
   499  ! SECTION 4.2: INITIALIZE CSV OUTPUT FILES  
   500  ! ========================================================================  
   501  ! TODO: Update CSV headers for new variables
   502      
   503  ! ========================================================================  
   504  ! SECTION 5: MAIN BESO OPTIMIZATION LOOP - ALL CONSTRAINTS ACTIVE   
   505  ! ========================================================================  
   506  change = 0          ! Initialize change variable
   507  converged = 0       ! Convergence flag (0=no, 1=yes)
   508      
   509  /COM, ========================================  
   510  /COM, STARTING BESO OPTIMIZATION - ALL CONSTRAINTS ACTIVE   
   511  /COM, ========================================  
   512      
   513  *DO, iter, 1, maxIter ! limit iterations for only 1 to cechk errors initially   
   514      ! ==================================================================
   515      ! 5.1: UPDATE MATERIAL PROPERTIES BASED ON ELEMENT DENSITIES
   516      ! ==================================================================
   517      /PREP7  
   518      
   519      ! Passive elements always solid 
   520      cmsel,s,PASSIVE_REGION  
   521      emodif,all,mat,1
   522      
   523      esel,s,,,DESIGN_DOMAIN  
   524      *GET, n_el, ELEM, NUM, COUNT
   525      *get, curr_elem, ELEM, 0, NUM, MIN  
   526      
   527     ! Design elements: assign material based on density  
   528      *DO, i, 1, n_el 
   529          *if, xe(curr_elem), LT, 0.5, THEN   
   530              emodif,curr_elem,mat,2 ! void material  
   531          *ELSE   
   532              emodif,curr_elem,mat,1 ! solid material 
   533          *ENDIF  
   534          *GET, curr_elem, ELEM, curr_elem, NXTH  ! choose next element   
   535      *ENDDO  
   536      ALLSEL  
   537      FINISH  
   538      
   539      ! ==================================================================
   540      ! 5.2: SOLVE FEA (ONLY ONE SOLVE PER ITERATION!)
   541      ! ==================================================================
   542      /SOLU   
   543      ANTYPE, STATIC  
   544      NCNV, 1, , , , , 1E10   
   545      NEQIT, 100  
   546      SOLVE   
   547      FINISH  
   548      
   549      ! ==================================================================
   550      ! 5.3: POST-PROCESS WITH DUAL P-NORM AGGREGATION
   551      ! ==================================================================
   552      /POST1  
   553      SET, 1, LAST
   554      
   555      ! ===== COMPLIANCE (ANALYTICAL) =====   
   556      ETABLE, SENE_TAB, SENE  
   557      SSUM
   558      *GET, totalSENE, SSUM, , ITEM, SENE_TAB 
   559      compliance(iter) = 2*totalSENE  
   560      
   561      ALLSEL  
   562      *VGET, sensit_C(1), ELEM, 1, ETAB, SENE_TAB 
   563      
   564      ! ===== P-NORM STRESS AGGREGATION ===== 
   565      ETABLE, SEQV_TAB, S, EQV
   566      ALLSEL  
   567      *VGET, elemStress(1), ELEM, 1, ETAB, SEQV_TAB   
   568      
   569      ! Find actual maximum for comparison
   570      *VSCFUN, maxStress, MAX, elemStress(1)  
   571      maxStressHistory(iter) = maxStress  
   572      
   573      ! START DEBUG FROM HERE 
   574      ! START DEBUG FROM HERE 
   575      ! START DEBUG FROM HERE 
   576      ! START DEBUG FROM HERE 
   577      ! P-NORM AGGREGATION
   578      ! STRESS FORMULATION:   
   579      ! -------------------   
   580      ! Instead of max(σ_i) ≤ σ_limit, we use:
   581      !   σ_pnorm = σ_ref × (Σ(σ_i/σ_ref)^p)^(1/p) ≤ σ_limit 
   582      ! Compute p-norm aggregated stress  
   583      sum_pnorm_stress = 0
   584      *DO, i, 1, numElem  
   585          *IF, elemStress(i), GT, 1E-6, THEN  
   586              ratio_s = elemStress(i) / sigma_ref 
   587              sum_pnorm_stress = sum_pnorm_stress + ratio_s**p_norm_stress
   588          *ENDIF  
   589      *ENDDO  
   590      stress_pnorm = sigma_ref * (sum_pnorm_stress**(1/p_norm_stress))
   591      stressPnormHistory(iter) = stress_pnorm 
   592      
   593      ! Calculate stress approximation error  
   594      stress_error = (stress_pnorm - maxStress) / maxStress * 100 
   595      pnormErrorStress(iter) = stress_error   
   596      
   597      ! Stress constraint using p-norm
   598      g_stress = (stress_pnorm - stress_limit) / stress_limit 
   599      g_stressHistory(iter) = g_stress
   600      
   601      ! ===== P-NORM ANALYTICAL STRESS SENSITIVITY =====  
   602      *DO, i, 1, numElem  
   603          *IF, elemStress(i), GT, 1E-6, THEN  
   604              ratio_stress = elemStress(i) / stress_pnorm 
   605              power_term_s = ratio_stress**(p_norm_stress - 1)
   606              norm_term_s = sigma_ref / stress_pnorm  
   607              dstress_dx = elemStress(i)  
   608              sensit_g_stress(i) = power_term_s * norm_term_s * dstress_dx / stress_limit 
   609      
   610              *IF, xe(i), LT, 0.5, THEN   
   611                  sensit_g_stress(i) = sensit_g_stress(i) * 0.1   
   612              *ENDIF  
   613          *ELSE   
   614              sensit_g_stress(i) = 0  
   615          *ENDIF  
   616      *ENDDO  
   617      
   618      ! ===== EXTRACT NODAL DISPLACEMENTS =====   
   619      ALLSEL  
   620      *VGET, nodeDispX(1), NODE, 1, U, X  
   621      *VGET, nodeDispY(1), NODE, 1, U, Y  
   622      *VGET, nodeDispZ(1), NODE, 1, U, Z  
   623      
   624      ! Identify BC nodes 
   625      CMSEL, S, FIXED_BC  
   626      *GET, numBCNodes, NODE, 0, COUNT
   627      
   628      *IF, numBCNodes, GT, 0, THEN
   629          *VFILL, isBCNode(1), RAMP, 0, 0 
   630          *GET, bcNode, NODE, 0, NUM, MIN 
   631          *DO, ii, 1, numBCNodes  
   632              isBCNode(bcNode) = 1
   633              *IF, ii, LT, numBCNodes, THEN   
   634                  *GET, bcNode, NODE, bcNode, NXTH
   635              *ENDIF  
   636          *ENDDO  
   637      *ENDIF  
   638      
   639      ALLSEL  
   640      
   641      ! ===== P-NORM DISPLACEMENT AGGREGATION =====   
   642      ! Calculate displacement magnitude for each node
   643      *GET, firstNode, NODE, 0, NUM, MIN  
   644      nodeID = firstNode  
   645      maxDispl = 0
   646      
   647      *DO, ii, 1, numNode 
   648          *IF, numBCNodes, GT, 0, THEN
   649              *IF, isBCNode(nodeID), EQ, 0, THEN  
   650                  ux = nodeDispX(nodeID)  
   651                  uy = nodeDispY(nodeID)  
   652                  uz = nodeDispZ(nodeID)  
   653                  nodeDisplMag(nodeID) = SQRT(ux*ux + uy*uy + uz*uz)  
   654                  *IF, nodeDisplMag(nodeID), GT, maxDispl, THEN   
   655                      maxDispl = nodeDisplMag(nodeID) 
   656                  *ENDIF  
   657              *ELSE   
   658                  nodeDisplMag(nodeID) = 0
   659              *ENDIF  
   660          *ELSE   
   661              ux = nodeDispX(nodeID)  
   662              uy = nodeDispY(nodeID)  
   663              uz = nodeDispZ(nodeID)  
   664              nodeDisplMag(nodeID) = SQRT(ux*ux + uy*uy + uz*uz)  
   665              *IF, nodeDisplMag(nodeID), GT, maxDispl, THEN   
   666                  maxDispl = nodeDisplMag(nodeID) 
   667              *ENDIF  
   668          *ENDIF  
   669          *IF, ii, LT, numNode, THEN  
   670              *GET, nodeID, NODE, nodeID, NXTH
   671          *ENDIF  
   672      *ENDDO  
   673      
   674      maxDisplHistory(iter) = maxDispl
   675      
   676      ! Compute p-norm aggregated displacement
   677      sum_pnorm_displ = 0 
   678      *GET, firstNode, NODE, 0, NUM, MIN  
   679      nodeID = firstNode  
   680      
   681      *DO, ii, 1, numNode 
   682          *IF, nodeDisplMag(nodeID), GT, 1E-12, THEN  
   683              ratio_d = nodeDisplMag(nodeID) / displ_ref  
   684              sum_pnorm_displ = sum_pnorm_displ + ratio_d**p_norm_displ   
   685          *ENDIF  
   686          *IF, ii, LT, numNode, THEN  
   687              *GET, nodeID, NODE, nodeID, NXTH
   688          *ENDIF  
   689      *ENDDO  
   690      
   691      displ_pnorm = displ_ref * (sum_pnorm_displ**(1/p_norm_displ))   
   692      displPnormHistory(iter) = displ_pnorm   
   693      
   694      ! Calculate displacement approximation error
   695      displ_error = (displ_pnorm - maxDispl) / maxDispl * 100 
   696      pnormErrorDispl(iter) = displ_error 
   697      
   698      ! Displacement constraint using p-norm  
   699      g_displ = (displ_pnorm - displ_limit_RMS) / displ_limit_RMS 
   700      g_displHistory(iter) = g_displ  
   701      
   702      /COM, ========================================  
   703      /COM, Iter %iter% Analysis: 
   704      /COM, Compliance = %compliance(iter)%   
   705      /COM, Max Stress = %maxStress% MPa, P-norm = %stress_pnorm% MPa (Error: %stress_error% pct) 
   706      /COM, Max Displ = %maxDispl% mm, P-norm = %displ_pnorm% mm (Error: %displ_error% pct)   
   707      /COM, g_stress = %g_stress*100% pct, g_displ = %g_displ*100% pct
   708      /COM, ========================================  
   709      
   710      ! ===== LCF (LOW CYCLE FATIGUE) CONSTRAINT (COMMENTED OUT - TO BE IMPLEMENTED) =====
   711      ! Calculate LCF life for each element using stress results  
   712      !   
   713      ! *DO, i, 1, numElem
   714      !     *IF, elemStress(i), GT, 1E-6, THEN
   715      !         ! Assume stress amplitude = von Mises / 2 (simplified)
   716      !         elemStressAmp(i) = elemStress(i) / 2.0
   717      !   
   718      !         ! Basquin-Coffin-Manson equation (elastic + plastic)  
   719      !         ! Δε/2 = (σ'_f/E)(2N)^b + ε'_f(2N)^c  
   720      !         ! Simplified: solve for N using stress amplitude  
   721      !   
   722      !         stress_ratio = elemStressAmp(i) / material_Sf_prime   
   723      !   
   724      !         ! Elastic component dominates for HCF, plastic for LCF
   725      !         ! Simplified calculation: 2N = (σ_a/σ'_f)^(1/b) 
   726      !         two_N = (stress_ratio)**(1.0/material_b)  
   727      !         elemLCF(i) = two_N / 2.0  
   728      !   
   729      !         ! Floor at 1 cycle to avoid numerical issues  
   730      !         *IF, elemLCF(i), LT, 1, THEN  
   731      !             elemLCF(i) = 1
   732      !         *ENDIF
   733      !     *ELSE 
   734      !         elemLCF(i) = 1E10  ! Very high life for low stress
   735      !     *ENDIF
   736      ! *ENDDO
   737      !   
   738      ! ! Find minimum LCF life   
   739      ! *VSCFUN, minLCF, MIN, elemLCF(1)  
   740      ! minLCFHistory(iter) = minLCF  
   741      !   
   742      ! ! P-norm aggregation for minimum life (inverted)  
   743      ! ! We want N_pnorm ≥ N_min, so aggregate 1/N instead 
   744      ! sum_pnorm_lcf = 0 
   745      ! lcf_ref = lcf_cycles_min  
   746      !   
   747      ! *DO, i, 1, numElem
   748      !     *IF, elemLCF(i), GT, 1, THEN  
   749      !         ! Aggregate reciprocal: Σ(N_ref/N_i)^p   
   750      !         ratio_lcf = lcf_ref / elemLCF(i)  
   751      !         sum_pnorm_lcf = sum_pnorm_lcf + ratio_lcf**p_norm_lcf 
   752      !     *ENDIF
   753      ! *ENDDO
   754      !   
   755      ! ! Inverse p-norm: N_pnorm = N_ref / (Σ(N_ref/N_i)^p)^(1/p)   
   756      ! lcf_pnorm = lcf_ref / (sum_pnorm_lcf**(1.0/p_norm_lcf))   
   757      ! lcfPnormHistory(iter) = lcf_pnorm 
   758      !   
   759      ! ! LCF error   
   760      ! lcf_error = (minLCF - lcf_pnorm) / minLCF * 100   
   761      ! pnormErrorLCF(iter) = lcf_error   
   762      !   
   763      ! ! LCF constraint: g_lcf = (N_min - N_pnorm) / N_min   
   764      ! ! Negative g_lcf means constraint satisfied   
   765      ! g_lcf = (lcf_cycles_min - lcf_pnorm) / lcf_cycles_min 
   766      ! g_lcfHistory(iter) = g_lcf
   767      !   
   768      ! /COM, LCF Analysis:   
   769      ! /COM, Min LCF Life = %minLCF% cycles  
   770      ! /COM, P-norm LCF Life = %lcf_pnorm% cycles
   771      ! /COM, LCF Constraint: g_lcf = %g_lcf*100% pct 
   772      
   773      ! ===== P-NORM ANALYTICAL DISPLACEMENT SENSITIVITY =====
   774      ! Map nodal p-norm sensitivity to element sensitivity   
   775      *VFILL, sensit_g_displ(1), RAMP, 0, 0   
   776      
   777      *DO, i, 1, numElem  
   778          ESEL, S, ELEM, , i  
   779          NSLE, S 
   780      
   781          *GET, numElemNodes, NODE, 0, COUNT  
   782      
   783          *IF, numElemNodes, GT, 0, THEN  
   784              *GET, elemNode, NODE, 0, NUM, MIN   
   785              elem_displ_sensit = 0   
   786      
   787              *DO, jj, 1, numElemNodes
   788                  *IF, nodeDisplMag(elemNode), GT, 1E-12, THEN
   789                      ! P-norm weight: (d_j/d_pnorm)^(p-1)
   790                      ratio_node = nodeDisplMag(elemNode) / displ_pnorm   
   791                      power_term_d = ratio_node**(p_norm_displ - 1)   
   792                      norm_term_d = displ_ref / displ_pnorm   
   793      
   794                      ! Heuristic: element contribution scaled by compliance  
   795                      dDispl_dx = sensit_C(i) * nodeDisplMag(elemNode) / (compliance(iter) + 1E-10)   
   796      
   797                      elem_displ_sensit = elem_displ_sensit + power_term_d*norm_term_d*dDispl_dx  
   798                  *ENDIF  
   799      
   800                  *IF, jj, LT, numElemNodes, THEN 
   801                      *GET, elemNode, NODE, elemNode, NXTH
   802                  *ENDIF  
   803              *ENDDO  
   804      
   805              sensit_g_displ(i) = elem_displ_sensit/(numElemNodes*displ_limit_RMS)
   806      
   807              *IF, xe(i), LT, 0.5, THEN   
   808                  sensit_g_displ(i) = sensit_g_displ(i) * 0.1 
   809              *ENDIF  
   810          *ENDIF  
   811      
   812          ALLSEL  
   813      *ENDDO  
   814      
   815      ALLSEL  
   816      
   817      ! ===== LCF SENSITIVITY (COMMENTED OUT - TO BE IMPLEMENTED) =====   
   818      ! P-norm analytical sensitivity for LCF constraint  
   819      !   
   820      ! *VFILL, sensit_g_lcf(1), RAMP, 0, 0   
   821      !   
   822      ! *DO, i, 1, numElem
   823      !     *IF, elemLCF(i), GT, 1, THEN  
   824      !         ! P-norm weight: (N_ref/N_i)^p / N_pnorm^(p-1)
   825      !         ratio_lcf_elem = lcf_ref / elemLCF(i) 
   826      !         power_term_lcf = ratio_lcf_elem**(p_norm_lcf - 1.0)   
   827      !         norm_term_lcf = lcf_ref / (lcf_pnorm**(p_norm_lcf - 1.0)) 
   828      !   
   829      !         ! Local LCF sensitivity: ∂N/∂x ≈ -N²/σ × ∂σ/∂x  
   830      !         ! Higher stress → lower life → higher sensitivity 
   831      !         dLCF_dx = -elemLCF(i)**2 / (elemStress(i) + 1E-6) * elemStress(i) 
   832      !   
   833      !         ! Combined sensitivity (normalized by constraint) 
   834      !         sensit_g_lcf(i) = power_term_lcf * norm_term_lcf * dLCF_dx / lcf_cycles_min   
   835      !   
   836      !         ! Penalize void elements  
   837      !         *IF, xe(i), LT, 0.5, THEN 
   838      !             sensit_g_lcf(i) = sensit_g_lcf(i) * 0.1   
   839      !         *ENDIF
   840      !     *ELSE 
   841      !         sensit_g_lcf(i) = 0   
   842      !     *ENDIF
   843      ! *ENDDO
   844      !   
   845      ! /COM, LCF sensitivities computed (analytical) 
   846      
   847      ! History averaging for stability   
   848      *IF, iter, GT, 1, THEN  
   849          *DO, i, 1, numElem  
   850              sensit_C(i) = (sensit_C(i) + sensit_old(i)) / 2 
   851          *ENDDO  
   852      *ENDIF  
   853      
   854      FINISH  
   855      
   856      ! ==================================================================
   857      ! 5.4: AUGMENTED LAGRANGIAN SENSITIVITY COMBINATION 
   858      ! ==================================================================
   859      
   860      sens_C_min = 1E30   
   861      sens_C_max = -1E30  
   862      *DO, i, 1, numElem  
   863          *IF, sensit_C(i), LT, sens_C_min, THEN  
   864              sens_C_min = sensit_C(i)
   865          *ENDIF  
   866          *IF, sensit_C(i), GT, sens_C_max, THEN  
   867              sens_C_max = sensit_C(i)
   868          *ENDIF  
   869      *ENDDO  
   870      
   871      ! Calculate effective Lagrange multipliers  
   872      *IF, g_stress, GT, 0, THEN  
   873          lambda_eff_stress = lambda_stress + mu_stress * g_stress
   874      *ELSE   
   875          lambda_eff_stress = lambda_stress   
   876      *ENDIF  
   877      
   878      *IF, g_displ, GT, 0, THEN   
   879          lambda_eff_displ = lambda_displ + mu_displ * g_displ
   880      *ELSE   
   881          lambda_eff_displ = lambda_displ 
   882      *ENDIF  
   883      
   884      ! LCF effective multiplier (COMMENTED OUT)  
   885      ! *IF, g_lcf, GT, 0, THEN   
   886      !     lambda_eff_lcf = lambda_lcf + mu_lcf * g_lcf  
   887      ! *ELSE 
   888      !     lambda_eff_lcf = lambda_lcf   
   889      ! *ENDIF
   890      
   891      ! Combine sensitivities 
   892      *DO, i, 1, numElem  
   893          sens_C_norm = (sensit_C(i) - sens_C_min) / (sens_C_max - sens_C_min + 1E-10)
   894          sensit_combined(i) = sens_C_norm
   895      
   896          weight_stress = ABS(lambda_eff_stress) / (1 + ABS(lambda_eff_stress))   
   897          sensit_combined(i) = sensit_combined(i) + weight_stress * sensit_g_stress(i)
   898      
   899          weight_displ = ABS(lambda_eff_displ) / (1 + ABS(lambda_eff_displ))  
   900          sensit_combined(i) = sensit_combined(i) + weight_displ * sensit_g_displ(i)  
   901      
   902          ! Add LCF constraint sensitivity (COMMENTED OUT)
   903          ! weight_lcf = ABS(lambda_eff_lcf) / (1 + ABS(lambda_eff_lcf))  
   904          ! sensit_combined(i) = sensit_combined(i) + weight_lcf * sensit_g_lcf(i)
   905      *ENDDO  
   906      
   907      *DO, i, 1, numElem  
   908          sensit_old(i) = sensit_combined(i)  
   909      *ENDDO  
   910      
   911      ! ==================================================================
   912      ! 5.5: APPLY SENSITIVITY FILTER 
   913      ! ==================================================================
   914      /PREP7  
   915      
   916      *DO, i, 1, numElem  
   917          sumW  = 0   
   918          sumWS = 0   
   919      
   920          *DO, k, 1, neighCount(i)
   921              j = neighList(i, k) 
   922              weight = neighWeight(i, k) * xe(j)  
   923              sumW   = sumW + weight  
   924              sumWS  = sumWS + weight*sensit_combined(j)  
   925          *ENDDO  
   926      
   927          *IF, sumW, GT, 0, THEN  
   928              sensit_filt(i) = sumWS / sumW   
   929          *ELSE   
   930              sensit_filt(i) = sensit_combined(i) 
   931          *ENDIF  
   932      *ENDDO  
   933      
   934      ! Connectivity-aware adjustment 
   935      *DO, i, 1, numElem  
   936          *IF, isDesign(i), EQ, 1, THEN   
   937              solidNeighbors = 0  
   938              *DO, k, 1, neighCount(i)
   939                  j = neighList(i, k) 
   940                  *IF, xe(j), GT, 0.5, THEN   
   941                      solidNeighbors = solidNeighbors + 1 
   942                  *ENDIF  
   943              *ENDDO  
   944      
   945              connectivityRatio = solidNeighbors / neighCount(i)  
   946      
   947              *IF, xe(i), GT, 0.5, THEN   
   948                  *IF, connectivityRatio, LT, 0.25, THEN  
   949                      sensit_filt(i) = sensit_filt(i) * 0.6   
   950                  *ELSEIF, connectivityRatio, LT, 0.4, THEN   
   951                      sensit_filt(i) = sensit_filt(i) * 0.8   
   952                  *ENDIF  
   953              *ELSE   
   954                  *IF, connectivityRatio, GT, 0.6, THEN   
   955                      sensit_filt(i) = sensit_filt(i) * 1.4   
   956                  *ELSEIF, connectivityRatio, GT, 0.45, THEN  
   957                      sensit_filt(i) = sensit_filt(i) * 1.2   
   958                  *ENDIF  
   959              *ENDIF  
   960          *ENDIF  
   961      *ENDDO  
   962      
   963      FINISH  
   964      
   965      ! ==================================================================
   966      ! 5.6: BESO UPDATE SCHEME   
   967      ! ==================================================================
   968      /PREP7  
   969      
   970      currentVol = 0  
   971      *DO, k, 1, numDesignElem
   972          i = designElemIdx(k)
   973          currentVol = currentVol + xe(i) 
   974      *ENDDO  
   975      volFrac_curr = currentVol / numDesignElem   
   976      volHistory(iter) = volFrac_curr 
   977      
   978      ! TODO: Dynamic evolution rate based on iteration   
   979      ! *IF, iter, LT, 10, THEN   
   980      !     ER = 0.50 
   981      ! *ELSEIF, iter, GE, 10, AND, iter, LT, 30, THEN
   982      !     ER = 0.30 
   983      ! *ELSEIF, iter, GE, 30, AND, iter, LT, 50, THEN
   984      !     ER = 0.20 
   985      ! *ELSE 
   986      !     ER = 0.10 
   987      ! *ENDIF
   988      
   989      *IF, volFrac_curr, GT, volfrac, THEN
   990          volFrac_tgt = volFrac_curr - ER 
   991          *IF, volFrac_tgt, LT, volfrac, THEN 
   992              volFrac_tgt = volfrac   
   993          *ENDIF  
   994      *ELSE   
   995          volFrac_tgt = volfrac   
   996      *ENDIF  
   997      
   998      g_vol = volFrac_curr - volfrac  
   999      g_volHistory(iter) = g_vol  
  1000      
  1001      ! Find sensitivity range
  1002      sens_min = 1E30 
  1003      sens_max = -1E30
  1004      *DO, k, 1, numDesignElem
  1005          i = designElemIdx(k)
  1006          *IF, sensit_filt(i), GT, sens_max, THEN 
  1007              sens_max = sensit_filt(i)   
  1008          *ENDIF  
  1009          *IF, sensit_filt(i), LT, sens_min, THEN 
  1010              sens_min = sensit_filt(i)   
  1011          *ENDIF  
  1012      *ENDDO  
  1013      
  1014      ! Bisection to find threshold   
  1015      *DO, bisect, 1, 50  
  1016          threshold = (sens_min + sens_max) / 2   
  1017      
  1018          testVol = 0 
  1019          *DO, k, 1, numDesignElem
  1020              i = designElemIdx(k)
  1021              *IF, sensit_filt(i), GE, threshold, THEN
  1022                  testVol = testVol + 1   
  1023              *ENDIF  
  1024          *ENDDO  
  1025          testVolFrac = testVol / numDesignElem   
  1026      
  1027          *IF, testVolFrac, GT, volFrac_tgt, THEN 
  1028              sens_min = threshold
  1029          *ELSE   
  1030              sens_max = threshold
  1031          *ENDIF  
  1032      
  1033          volError = ABS(testVolFrac - volFrac_tgt)   
  1034          *IF, volError, LT, 0.001, THEN  
  1035              *EXIT   
  1036          *ENDIF  
  1037      *ENDDO  
  1038      
  1039      ! Update densities  
  1040      *DO, k, 1, numDesignElem
  1041          i = designElemIdx(k)
  1042          *IF, sensit_filt(i), GE, threshold, THEN
  1043              xe(i) = 1.0 
  1044          *ELSE   
  1045              xe(i) = xmin
  1046          *ENDIF  
  1047      *ENDDO  
  1048      
  1049      FINISH  
  1050      
  1051      ! ==================================================================
  1052      ! 5.7: UPDATE AUGMENTED LAGRANGIAN PARAMETERS   
  1053      ! ==================================================================
  1054      
  1055      *IF, g_stress, GT, 0, THEN  
  1056          lambda_stress = lambda_stress + lambda_update * mu_stress * g_stress
  1057          *IF, lambda_stress, LT, 0, THEN 
  1058              lambda_stress = 0   
  1059          *ENDIF  
  1060      *ENDIF  
  1061      
  1062      *IF, g_displ, GT, 0, THEN   
  1063          lambda_displ = lambda_displ + lambda_update * mu_displ * g_displ
  1064          *IF, lambda_displ, LT, 0, THEN  
  1065              lambda_displ = 0
  1066          *ENDIF  
  1067      *ENDIF  
  1068      
  1069      *IF, g_stress, GT, tol_constraint, THEN 
  1070          mu_stress = mu_stress * mu_update   
  1071          *IF, mu_stress, GT, mu_max, THEN
  1072              mu_stress = mu_max  
  1073          *ENDIF  
  1074          /COM, Stress penalty increased: Mu_stress = %mu_stress% 
  1075      *ENDIF  
  1076      
  1077      *IF, g_displ, GT, tol_constraint, THEN  
  1078          mu_displ = mu_displ * mu_update 
  1079          *IF, mu_displ, GT, mu_max, THEN 
  1080              mu_displ = mu_max   
  1081          *ENDIF  
  1082          /COM, Displacement penalty increased: Mu_displ = %mu_displ% 
  1083      *ENDIF  
  1084      
  1085      ! LCF parameter updates (COMMENTED OUT) 
  1086      ! *IF, g_lcf, GT, 0, THEN   
  1087      !     lambda_lcf = lambda_lcf + lambda_update * mu_lcf * g_lcf  
  1088      !     *IF, lambda_lcf, LT, 0, THEN  
  1089      !         lambda_lcf = 0
  1090      !     *ENDIF
  1091      ! *ENDIF
  1092      !   
  1093      ! *IF, g_lcf, GT, tol_constraint, THEN  
  1094      !     mu_lcf = mu_lcf * mu_update   
  1095      !     *IF, mu_lcf, GT, mu_max, THEN 
  1096      !         mu_lcf = mu_max   
  1097      !     *ENDIF
  1098      !     /COM, LCF penalty increased: Mu_lcf = %mu_lcf%
  1099      ! *ENDIF
  1100      
  1101      lambdaStressHistory(iter) = lambda_stress   
  1102      lambdaDisplHistory(iter) = lambda_displ 
  1103      muStressHistory(iter) = mu_stress   
  1104      muDisplHistory(iter) = mu_displ 
  1105      
  1106      ! LCF history (COMMENTED OUT)   
  1107      ! lambdaLCFHistory(iter) = lambda_lcf   
  1108      ! muLCFHistory(iter) = mu_lcf   
  1109      
  1110      ! ==================================================================
  1111      ! 5.8: CHECK CONVERGENCE
  1112      ! ==================================================================
  1113      
  1114      *IF, iter, GT, conv_window, THEN
  1115          avg1 = 0
  1116          avg2 = 0
  1117          *DO, k, 0, conv_window-1
  1118              idx1 = iter - k 
  1119              idx2 = iter - k - conv_window   
  1120              *IF, idx2, GT, 0, THEN  
  1121                  avg1 = avg1 + compliance(idx1)  
  1122                  avg2 = avg2 + compliance(idx2)  
  1123              *ENDIF  
  1124          *ENDDO  
  1125          avg1 = avg1 / conv_window   
  1126          avg2 = avg2 / conv_window   
  1127      
  1128          *IF, avg2, GT, 0, THEN  
  1129              change = ABS(avg1 - avg2) / avg1
  1130          *ELSE   
  1131              change = 1  
  1132          *ENDIF  
  1133      
  1134          *IF, change, LT, convTol, THEN  
  1135              *IF, volFrac_curr, LE, volfrac + 0.001, THEN
  1136                  *IF, g_stress, LE, tol_constraint, THEN 
  1137                      *IF, g_displ, LE, tol_constraint, THEN  
  1138                          ! LCF convergence check (COMMENTED OUT) 
  1139                          ! *IF, g_lcf, LE, tol_constraint, THEN  
  1140                          converged = 1   
  1141                          /COM, ========================================  
  1142                          /COM, *** CONVERGED at iteration %iter% *** 
  1143                          /COM, Final Compliance = %compliance(iter)% 
  1144                          /COM, Final Volume Fraction = %volFrac_curr%
  1145                          /COM, Final P-norm Stress = %stress_pnorm% MPa  
  1146                          /COM, Final P-norm Displacement = %displ_pnorm% mm  
  1147                          /COM, ========================================  
  1148      
  1149                          finalIter = iter
  1150                          *EXIT   
  1151                          ! *ENDIF  ! End LCF check (COMMENTED OUT)   
  1152                      *ENDIF  
  1153                  *ENDIF  
  1154              *ENDIF  
  1155          *ENDIF  
  1156      *ENDIF  
  1157      
  1158      ! ==================================================================
  1159      ! 5.9: WRITE PROGRESS   
  1160      ! ==================================================================
  1161      /COM, Iter %iter%: C=%compliance(iter)%, Vol=%volFrac_curr%, Change=%change%
  1162      esel,s,mat,,1   
  1163      cm, SOLID_TOPOLOGY_%iter%, ELEM 
  1164      allsel  
  1165  *ENDDO  
  1166      
  1167  ! ========================================================================  
  1168  ! SECTION 6: POST-PROCESSING
  1169  ! ========================================================================  
  1170  /PREP7  
  1171      
  1172  ESEL, S, MAT, , 1   
  1173      
  1174  /PNUM, ELEM, 0  
  1175  /NUMBER, 0  
  1176  /VIEW, 1, 1, 1, 1   
  1177  /ANG, 1 
  1178  /REPLOT 
  1179  EPLOT   
  1180      
  1181  CM, SOLID_TOPOLOGY, ELEM
  1182  ALLSEL  
  1183      
  1184  /COM, ========================================  
  1185  /COM, BESO DUAL P-NORM OPTIMIZATION COMPLETE
  1186  /COM, ========================================  
  1187  /COM, P-Norm Stress Parameter: %p_norm_stress%  
  1188  /COM, P-Norm Displacement Parameter: %p_norm_displ% 
  1189  /COM, Target Volume Fraction: %volfrac% 
  1190  /COM, Final Compliance: %compliance(iter)%  
  1191  /COM, Final Volume Fraction: %volFrac_curr% 
  1192  /COM, Final Max Stress: %maxStress% MPa 
  1193  /COM, Final P-norm Stress: %stress_pnorm% MPa (Error: %stress_error*100% pct)   
  1194  *IF, g_stress, LE, tol_constraint, THEN 
  1195      /COM, Stress Constraint: SATISFIED  
  1196  *ELSE   
  1197      /COM, Stress Constraint: VIOLATED (%g_stress*100% percent)  
  1198  *ENDIF  
  1199  /COM, Final Max Displacement: %maxDispl% mm 
  1200  /COM, Final P-norm Displacement: %displ_pnorm% mm (Error: %displ_error*100% pct)
  1201  *IF, g_displ, LE, tol_constraint, THEN  
  1202      /COM, Displacement Constraint: SATISFIED
  1203  *ELSE   
  1204      /COM, Displacement Constraint: VIOLATED (%g_displ*100% percent) 
  1205  *ENDIF  
  1206  /COM, ========================================  

 RUN SETUP PROCEDURE FROM FILE= C:\Program Files\ANSYS Inc\v194\ANSYS\apdl\start.ans

 /INPUT FILE= C:\Program Files\ANSYS Inc\v194\ANSYS\apdl\start.ans  LINE=       0

 *** WARNING ***                         CP =       0.375   TIME= 23:19:22
 The /BATCH command must be the first line of input.  The /BATCH command 
 is ignored.                                                             

 CLEAR ANSYS DATABASE AND RESTART

 ANSYS Mechanical Enterprise                       

 CURRENT JOBNAME REDEFINED AS beso_2020

 *** NOTE ***                            CP =       0.391   TIME= 23:19:22
 The defined jobname (beso_2020) contains a numeric value (0->9) for the 
 last character.  Therefore, when creating local solution files          
 Distributed ANSYS will append an underscore to the jobname prior to     
 appending the MPI rank.                                                 
     Opening new LOG, ERROR, LOCK and PAGE FILES
  BESO Topology Optimization with Augmented Lagrange for Volume, Stress and Disp
  Modified by Suleyman Yasayanlar 2026
  Be aware of units used in the model (N, mm)
  Be aware of material numbers for design and passive domains
  Material 1 : Design Material
  Material 2 : Void Material
  If submodel please add cut BCs in Section 3
  Clear all previous data

 SYSTEM= 
  del *.esav


 SYSTEM= 
  del *.full


 SYSTEM= 
  del *.mntr


 SYSTEM= 
  del *.page

C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION0.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION1.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION10.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION11.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION2.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION3.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION4.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION5.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION6.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION7.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION8.page
The process cannot access the file because it is being used by another process.
C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION9.page
The process cannot access the file because it is being used by another process.

 SYSTEM= 
  del *.rst


 SYSTEM= 
  del *.stat


 SYSTEM= 
  del *.db

Could Not Find C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\*.db

 SYSTEM= 
  del *.lock

C:\Users\Suleyman\Documents\01_DER_BESO_OPT\BESO-in-ANSYS\BESO_APPLICATION.lock
The process cannot access the file because it is being used by another process.

 PARAMETER _PI =     3.141592654    

 PARAMETER EPS_MACHINE =    0.1000000000E-15

 PARAMETER E_DESIGN =     200000.0000    

 PARAMETER NU_DESIGN =    0.3000000000    

 PARAMETER VOID_PARAM =    0.1000000000E-08

 PARAMETER E_VOID =    0.2000000000E-03

 PARAMETER NU_VOID =    0.3000000000    
  Element size and filter radius must be double checked with FEA model

 PARAMETER ESIZE_ =     20.00000000    

 PARAMETER RMIN =     50.00000000    

 PARAMETER VOLFRAC =    0.2500000000    

 PARAMETER ER =    0.1500000000    

 PARAMETER MAXITER =     100.0000000    

 PARAMETER CONVTOL =    0.2000000000E-02

 PARAMETER CONV_WINDOW =     5.000000000    

 PARAMETER XMIN =    0.1000000000E-02

 PARAMETER STRESS_LIMIT =     420.0000000    

 PARAMETER DISPL_LIMIT_RMS =     50.00000000    

 PARAMETER TOL_CONSTRAINT =    0.5000000000E-01

 PARAMETER P_NORM_STRESS =     8.000000000    

 PARAMETER P_NORM_DISPL =     6.000000000    

 PARAMETER SIGMA_REF =     420.0000000    

 PARAMETER DISPL_REF =     50.00000000    

 PARAMETER LAMBDA_STRESS =     0.000000000    

 PARAMETER LAMBDA_DISPL =     0.000000000    

 PARAMETER MU_STRESS =    0.1000000000E-07

 PARAMETER MU_DISPL =    0.1000000000E-07

 PARAMETER MU_MAX =    0.1000000000E-03

 PARAMETER MU_UPDATE =     10.00000000    

 PARAMETER LAMBDA_UPDATE =    0.5000000000    
  ========================================================================

 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:23  JAN 11, 2026 CP=      0.391

                                                                               



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****

 TEMPERATURE TABLE ERASED.

 *** PROPERTY TEMPERATURE TABLE    NUM. TEMPS=  1 ***
 SLOC=   1     0.000000    

 PROPERTY TABLE EX    MAT=      1  NUM. POINTS=  1
 SLOC=   1     200000.0    

 PROPERTY TABLE PRXY  MAT=      1  NUM. POINTS=  1
 SLOC=   1    0.3000000    

 TEMPERATURE TABLE ERASED.

 *** PROPERTY TEMPERATURE TABLE    NUM. TEMPS=  1 ***
 SLOC=   1     0.000000    

 PROPERTY TABLE EX    MAT=      2  NUM. POINTS=  1
 SLOC=   1    0.2000000E-03

 PROPERTY TABLE PRXY  MAT=      2  NUM. POINTS=  1
 SLOC=   1    0.3000000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW


 ***** ROUTINE COMPLETED *****  CP =         0.391



 /INPUT FILE= .\simple_block.cdb  LINE=       0

 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:23  JAN 11, 2026 CP=      0.391

                                                                               



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****

 *IF  _CDRDOFF                          ( =  0.788861E-30 )  EQ  
      1                                 ( =   1.00000     )  THEN    

 *ELSE

 OFFSET NODE NUMBERS BY    17576

 OFFSET ELEMENT NUMBERS BY    16250

 OFFSET ELEMENT TYPE NUMBERS BY        1

 *ENDIF

 NBLOCK format=(3i8,6e16.9)                                                

 ELEMENT TYPE       1 IS SOLID185     3-D 8-NODE STRUCTURAL SOLID 
  KEYOPT( 1- 6)=        0      0      0        0      0      0
  KEYOPT( 7-12)=        0      0      0        0      0      0
  KEYOPT(13-18)=        0      0      0        0      0      0

 CURRENT NODAL DOF SET IS  UX    UY    UZ  
  THREE-DIMENSIONAL MODEL

 ELEMENT TYPE       1 IS SOLID185     3-D 8-NODE STRUCTURAL SOLID 
  KEYOPT( 1- 6)=        0      2      0        0      0      0
  KEYOPT( 7-12)=        0      0      0        0      0      0
  KEYOPT(13-18)=        0      0      0        0      0      0

 CURRENT NODAL DOF SET IS  UX    UY    UZ  
  THREE-DIMENSIONAL MODEL

 ELEMENT TYPE SET TO         1

 MATERIAL NUMBER SET TO         1

 REAL CONSTANT NUMBER=        1

 EBLOCK read of  19 nodes per line
 Format= (19i8)                                                                

 EBLOCK input of    15625 elements completed

 DEFINITION OF COMPONENT = BLOCK_001  ENTITY=ELEM

 NONE SELECT  FOR ITEM=ELEM COMPONENT=    
  IN RANGE         1 TO      16250 STEP          1

          0  ELEMENTS (OF      15625  DEFINED) SELECTED BY ESEL  COMMAND.

 ALL SELECT   FOR ITEM=ELEM COMPONENT=    
  IN RANGE         1 TO      16250 STEP          1

      15625  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.
 CMBLOCK read of NODE component FIXED_BC  completed
 CMBLOCK read of NODE component FORCE_BC  completed
 CMBLOCK read of ELEM component PASSIVE_REGION  completed
 CMBLOCK read of ELEM component DESIGN_DOMAIN  completed


 ***** ROUTINE COMPLETED *****  CP =         0.953



 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:23  JAN 11, 2026 CP=      0.953

                                                                               



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW
  For initial study all numberings are reset

 COMPRESS NODE NUMBERS
      MAXIMUM NODE NUMBER COMPRESSED FROM     17576 TO     17576

 COMPRESS ELEMENT NUMBERS
      MAXIMUM ELEMENT NUMBER COMPRESSED FROM     16250 TO     15625

 COMPRESS KEYPOINT NUMBERS

 COMPRESS LINE NUMBERS

 COMPRESS AREA NUMBERS

 COMPRESS VOLUME NUMBERS

 COMPRESS MATERIAL NUMBERS
      MAXIMUM MATERIAL NUMBER COMPRESSED FROM       2 TO       2

 COMPRESS ELEMENT TYPE NUMBERS
      MAXIMUM ELEMENT TYPE NUMBER COMPRESSED FROM         1 TO         1

 COMPRESS REAL CONSTANT NUMBERS

 COMPRESS SECTION NUMBERS

 COMPRESS COUPLED DOF SET NUMBERS

 COMPRESS CONSTRAINT EQUATION NUMBERS

 *** NOTE *** Display device has not yet been specified with the /SHOW command.  Display commands ignored. 

 TITLE= 
  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



 ***** ROUTINE COMPLETED *****  CP =         0.953



 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:23  JAN 11, 2026 CP=      0.953

  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****
  If you have other domains please assign materials accordingly

 ALL SELECT   FOR ITEM=ELEM COMPONENT=    
  IN RANGE         1 TO      15625 STEP          1

      15625  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 MODIFY ALL SELECTED ELEMENTS STARTING AT NODE LOCATION  0
 SELECTED ELEMENTS SET TO TYPE=     1  MAT=     1  REAL=      1  ESYS=  0 SEC=      1

         16  NODES (OF      17576  DEFINED) SELECTED BY  NSEL  COMMAND.

 SPECIFIED CONSTRAINT UX   FOR SELECTED NODES            1 TO       17576 BY           1
 REAL=  0.00000000       IMAG=  0.00000000    
 ADDITIONAL DOFS=  UY    UZ  

         16  NODES (OF      17576  DEFINED) SELECTED BY  NSEL  COMMAND.

 SPECIFIED NODAL LOAD FZ   FOR SELECTED NODES         1 TO    17576 BY        1
  REAL= -625000.000       IMAG=  0.00000000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW


 ***** ROUTINE COMPLETED *****  CP =         1.797



 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:23  JAN 11, 2026 CP=      1.859

  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 *GET  NUMELEM   FROM  ELEM  ITEM=COUN           VALUE=  15625.0000    

 *GET  NUMNODE   FROM  NODE  ITEM=COUN       VALUE=  17576.0000     

      15370  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  NUMDESIGNELEM  FROM  ELEM  ITEM=COUN           VALUE=  15370.0000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

        255  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  NUMPASSIVEELEM  FROM  ELEM  ITEM=COUN           VALUE=  255.000000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW
  ========================================
  BESO WITH DUAL P-NORM AGGREGATION
  Total Elements: 15625
  Total Nodes: 17576
  Design Domain Elements: 15370
  Passive Region Elements: 255
  Units are N and mm
  For later cases we can use in and psi units
  Volume Fraction Target: 0.25
  Evolution Rate: 0.15 per iteration
  Maximum Iterations: 100
  Convergence Tolerance: 2.E-03
  P-Norm Stress: 8
  P-Norm Displacement: 6
  Stress Limit: 420 MPa
  Displacement Limit: 50 mm
  ========================================

 SET PARAMETER DIMENSIONS ON  XE TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  SENSIT_C TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  SENSIT_G_STRESS
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  SENSIT_G_DISPL
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  SENSIT_COMBINED
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  SENSIT_FILT
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  SENSIT_OLD
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  ELEMCENX TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  ELEMCENY TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  ELEMCENZ TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  ELEMVOL TYPE=ARRA  DIMENSIONS= 15625     1     1

 SET PARAMETER DIMENSIONS ON  COMPLIANCE
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  VOLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  STRESSPNORMHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  MAXSTRESSHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  DISPLPNORMHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  MAXDISPLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  LAMBDASTRESSHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  LAMBDADISPLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  MUSTRESSHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  MUDISPLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  G_STRESSHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  G_DISPLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  G_VOLHISTORY
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  PNORMERRORSTRESS
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  PNORMERRORDISPL
  TYPE=ARRA  DIMENSIONS=      100        1        1

 SET PARAMETER DIMENSIONS ON  ELEMSTRESS
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  NODEDISPX
  TYPE=ARRA  DIMENSIONS=    17576        1        1

 SET PARAMETER DIMENSIONS ON  NODEDISPY
  TYPE=ARRA  DIMENSIONS=    17576        1        1

 SET PARAMETER DIMENSIONS ON  NODEDISPZ
  TYPE=ARRA  DIMENSIONS=    17576        1        1

 SET PARAMETER DIMENSIONS ON  NODEDISPLMAG
  TYPE=ARRA  DIMENSIONS=    17576        1        1

 SET PARAMETER DIMENSIONS ON  ISBCNODE TYPE=ARRA  DIMENSIONS= 17576     1     1

 PARAMETER NUMNEIGHINCREASE =     100.0000000    

 PARAMETER MAXNEIGHBORS =     360.0000000    

 PARAMETER MAXNEIGHBORS =     460.0000000    

 SET PARAMETER DIMENSIONS ON  NEIGHCOUNT
  TYPE=ARRA  DIMENSIONS=    15625        1        1

 SET PARAMETER DIMENSIONS ON  NEIGHLIST
  TYPE=ARRA  DIMENSIONS=    15625      460        1

 SET PARAMETER DIMENSIONS ON  NEIGHWEIGHT
  TYPE=ARRA  DIMENSIONS=    15625      460        1

 SET PARAMETER DIMENSIONS ON  ISDESIGN TYPE=ARRA  DIMENSIONS= 15625     1     1

 VECTOR FILL OPERATION  *VFILL  
  xe(1)            = RAMP
 VECTOR LENGTH=   15625
 INITIAL VALUE=  1.0000      STEP INCREMENT=  0.0000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 VECTOR GET OPERATION  elemCenX(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  CENT  X   

 VECTOR GET OPERATION  elemCenY(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  CENT  Y   

 VECTOR GET OPERATION  elemCenZ(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  CENT  Z   

 VECTOR GET OPERATION  elemVol(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  GEOM      

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW
  Pre-computing neighbor list for 3D filter...

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15625.     BY  1.0000    

 PARAMETER NEIGHCOUNT(I) =     0.000000000    

 PARAMETER CX_I =     340.0000000    

 PARAMETER CY_I =     340.0000000    

 PARAMETER CZ_I =     490.0000000    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 SELECT       FOR ITEM=LOC  COMPONENT=X     BETWEEN  290.00     AND   390.00    
   KABS=  0.  TOLERANCE= 0.100000E-05

       1352  NODES (OF      17576  DEFINED) SELECTED BY  NSEL  COMMAND.

 RESELECT     FOR ITEM=LOC  COMPONENT=Y     BETWEEN  290.00     AND   390.00    
   KABS=  0.  TOLERANCE= 0.100000E-05

        104  NODES (OF      17576  DEFINED) SELECTED BY  NSEL  COMMAND.

 RESELECT     FOR ITEM=LOC  COMPONENT=Z     BETWEEN  440.00     AND   540.00    
   KABS=  0.  TOLERANCE= 0.100000E-05

         16  NODES (OF      17576  DEFINED) SELECTED BY  NSEL  COMMAND.

 SELECT      ONLY ELEMENTS COMPLETELY CONTAINED WITHIN NODE SET.

          3 ELEMENTS (OF      15625  DEFINED) SELECTED FROM
       16 SELECTED NODES BY  ESLN COMMAND.

 *GET  NUMNEIGH  FROM  ELEM  ITEM=COUN           VALUE=  3.00000000    

 *IF  numNeigh                          ( =   3.00000     )  GT  
      0                                 ( =   0.00000     )  THEN    

 *GET  J         FROM  ELEM  ITEM=NUM  MIN       VALUE=  1.00000000    

 *DO LOOP ON PARAMETER= K FROM  1.0000     TO  3.0000     BY  1.0000    

 PARAMETER DX =     0.000000000    

 PARAMETER DY =     0.000000000    

 PARAMETER DZ =     0.000000000    

 PARAMETER DIST =     0.000000000    

 *IF  dist                              ( =   0.00000     )  LT  
      Rmin                              ( =   50.0000     )  THEN    

 PARAMETER NEIGHCOUNT(I) =     1.000000000    

 PARAMETER NC =     1.000000000    

 PARAMETER NEIGHLIST(I,NC) =     1.000000000    

 PARAMETER NEIGHWEIGHT(I,NC) =     50.00000000    

 *IF  nc                                ( =   1.00000     )  GE  
      maxNeighbors                      ( =   460.000     )  THEN    

 *ENDIF

 *ENDIF

 *IF  k                                 ( =   1.00000     )  LT  
      numNeigh                          ( =   3.00000     )  THEN    

 *GET  J         FROM  ELEM         1  ITEM=NXTH           VALUE=  2.00000000    

 *ENDIF

 *ENDDO  INDEX= K                               

 *ENDIF

 *IF  MOD(i,500)                        ( =   1.00000     )  EQ  
      0                                 ( =   0.00000     )  THEN    

 *ENDIF

 *ENDDO  INDEX= I                               
  Processed element 500 of 15625
  Processed element 1000 of 15625
  Processed element 1500 of 15625
  Processed element 2000 of 15625
  Processed element 2500 of 15625
  Processed element 3000 of 15625
  Processed element 3500 of 15625
  Processed element 4000 of 15625
  Processed element 4500 of 15625
  Processed element 5000 of 15625
  Processed element 5500 of 15625
  Processed element 6000 of 15625
  Processed element 6500 of 15625
  Processed element 7000 of 15625
  Processed element 7500 of 15625
  Processed element 8000 of 15625
  Processed element 8500 of 15625
  Processed element 9000 of 15625
  Processed element 9500 of 15625
  Processed element 10000 of 15625
  Processed element 10500 of 15625
  Processed element 11000 of 15625
  Processed element 11500 of 15625
  Processed element 12000 of 15625
  Processed element 12500 of 15625
  Processed element 13000 of 15625
  Processed element 13500 of 15625
  Processed element 14000 of 15625
  Processed element 14500 of 15625
  Processed element 15000 of 15625
  Processed element 15500 of 15625

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW
  Neighbor list computed.

 PARAMETER NUMDESIGNELEM =     0.000000000    

 PARAMETER NUMPASSIVEELEM =     0.000000000    

 VECTOR FILL OPERATION  *VFILL  
  isDesign(1)      = RAMP
 VECTOR LENGTH=   15625
 INITIAL VALUE=  1.0000      STEP INCREMENT=  0.0000    

        255  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  NUMPASSIVEELEM  FROM  ELEM  ITEM=COUN           VALUE=  255.000000    

 *GET  CURR_ELEM  FROM  ELEM  ITEM=NUM  MIN       VALUE=  698.000000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  255.00     BY  1.0000    

 PARAMETER ISDESIGN(CURR_ELEM) =     0.000000000    

 *GET  CURR_ELEM  FROM  ELEM       698  ITEM=NXTH           VALUE=  699.000000    

 PARAMETER NUMPASSIVEELEM =     256.0000000    

 *ENDDO  INDEX= I                               

      15370  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  NUMDESIGNELEM  FROM  ELEM  ITEM=COUN           VALUE=  15370.0000    
  ========================================
  ELEMENT & NODE NUMBERS ARE RESET INITALLY
  DOMAIN INFORMATION:
  Total Elements: 15625
  Design Elements: 15370
  Passive Elements: 255
  ========================================

 SET PARAMETER DIMENSIONS ON  DESIGNELEMIDX
  TYPE=ARRA  DIMENSIONS=    15370        1        1

 PARAMETER IDX =     0.000000000    

      15370  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  N_EL      FROM  ELEM  ITEM=COUN           VALUE=  15370.0000    

 *GET  CURR_ELEM  FROM  ELEM  ITEM=NUM  MIN       VALUE=  1.00000000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15370.     BY  1.0000    

 PARAMETER IDX =     1.000000000    

 PARAMETER DESIGNELEMIDX(IDX) =     1.000000000    

 *GET  CURR_ELEM  FROM  ELEM         1  ITEM=NXTH           VALUE=  2.00000000    

 *ENDDO  INDEX= I                               

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 PARAMETER TOTALVOL =     15370.00000    

 PARAMETER CURRENTVOL =     15370.00000    


 ***** ROUTINE COMPLETED *****  CP =       162.906


  ========================================================================
  DESIGN SETUP COMPLETE. READY FOR OPTIMIZATION LOOP.
  PLEASE CHECK BCs, LOADS, MATERIALS BEFORE PROCEEDING.
  ELEMENTS IN DESIGN DOMAIN: 15370
  ELEMENTS IN PASSIVE REGION: 510
  OPTIMIZATION WILL BE PERFORMED IN DESIGN_DOMAIN ONLY.
  IF YOU WANT YOU CAN ALWAYS TWEAK OPTIMIZATION PARAMETERS IN beso_2020.in
  ========================================================================

 PARAMETER CHANGE =     0.000000000    

 PARAMETER CONVERGED =     0.000000000    
  ========================================
  STARTING BESO OPTIMIZATION - ALL CONSTRAINTS ACTIVE
  ========================================

 *DO LOOP ON PARAMETER= ITER FROM  1.0000     TO  100.00     BY  1.0000    

 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:37  JAN 11, 2026 CP=    162.906

  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



          ***** ANSYS ANALYSIS DEFINITION (PREP7) *****

 SELECT      COMPONENT PASSIVE_REGION                  

 MODIFY ALL SELECTED ELEMENTS TO HAVE  MAT  =         1

      15370  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 *GET  N_EL      FROM  ELEM  ITEM=COUN           VALUE=  15370.0000    

 *GET  CURR_ELEM  FROM  ELEM  ITEM=NUM  MIN       VALUE=  1.00000000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15370.     BY  1.0000    

 *IF  xe(curr_elem)                     ( =   1.00000     )  LT  
      0.5                               ( =  0.500000     )  THEN    

 *ELSE

 MODIFY ELEMENT         1 (IF SELECTED) TO HAVE  MAT  =      1
     ELEM    MAT   TYP   REL   SEC   ESYS         NODES
       1   1   1      1      1    0     154   153   159   157   677   680   679   678


 *ENDIF

 *GET  CURR_ELEM  FROM  ELEM         1  ITEM=NXTH           VALUE=  2.00000000    

 *ENDDO  INDEX= I                               

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW


 ***** ROUTINE COMPLETED *****  CP =       165.625



 *****  ANSYS SOLUTION ROUTINE  *****


 PERFORM A STATIC ANALYSIS
  THIS WILL BE A NEW ANALYSIS

 KEY TO TERMINATE RUN IF NO CONVERGENCE=  1
 DEGREE OF FREEDOM (DISPLACEMENT) LIMIT=  0.0000    
 CUMULATIVE ITERATION LIMIT=     0
 ELAPSED TIME LIMIT (SEC)=  0.0000       (  0 HOURS  0 MIN)
 CPU TIME LIMIT (SEC)=  0.0000       (  0 HOURS  0 MIN)

 USE A MAXIMUM OF   100 EQUILIBRIUM ITERATIONS EACH SUBSTEP

 *** NOTE ***                            CP =     165.656   TIME= 23:19:37
 The automatic domain decomposition logic has selected the MESH domain   
 decomposition method with 12 processes per solution.                    

 *****  ANSYS SOLVE    COMMAND  *****

 *** SELECTION OF ELEMENT TECHNOLOGIES FOR APPLICABLE ELEMENTS ***
                ---GIVE SUGGESTIONS ONLY---

 ELEMENT TYPE    1 IS SOLID185. IT IS ASSOCIATED WITH LINEAR MATERIALS ONLY
 AND POISSON'S RATIO IS NOT GREATER THAN 0.49. KEYOPT(2)=3 IS SUGGESTED.



 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:37  JAN 11, 2026 CP=    165.781

  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



                       S O L U T I O N   O P T I O N S

   PROBLEM DIMENSIONALITY. . . . . . . . . . . . .3-D                  
   DEGREES OF FREEDOM. . . . . . UX   UY   UZ  
   ANALYSIS TYPE . . . . . . . . . . . . . . . . .STATIC (STEADY-STATE)
   GLOBALLY ASSEMBLED MATRIX . . . . . . . . . . .SYMMETRIC  

 *** NOTE ***                            CP =     165.781   TIME= 23:19:37
 Present time 0 is less than or equal to the previous time.  Time will   
 default to 1.                                                           

 *** NOTE ***                            CP =     165.781   TIME= 23:19:37
 The conditions for direct assembly have been met.  No .emat or .erot    
 files will be produced.                                                 

  
  
     D I S T R I B U T E D   D O M A I N   D E C O M P O S E R
  
  ...Number of elements: 15625
  ...Number of nodes:    17576
  ...Decompose to 12 CPU domains
  ...Element load balance ratio =     1.001


                      L O A D   S T E P   O P T I O N S

   LOAD STEP NUMBER. . . . . . . . . . . . . . . .     1
   TIME AT END OF THE LOAD STEP. . . . . . . . . .  1.0000    
   NUMBER OF SUBSTEPS. . . . . . . . . . . . . . .     1
   STEP CHANGE BOUNDARY CONDITIONS . . . . . . . .    NO
   PRINT OUTPUT CONTROLS . . . . . . . . . . . . .NO PRINTOUT
   DATABASE OUTPUT CONTROLS. . . . . . . . . . . .ALL DATA WRITTEN
                                                  FOR THE LAST SUBSTEP


 SOLUTION MONITORING INFO IS WRITTEN TO FILE= beso_2020.mntr                                                                                                                                                                                                                                                      


 Range of element maximum matrix coefficients in global coordinates
 Maximum = 2413512.41 at element 13805.                                  
 Minimum = 2413512.41 at element 13768.                                  

   *** ELEMENT MATRIX FORMULATION TIMES
     TYPE    NUMBER   ENAME      TOTAL CP  AVE CP

        1     15625  SOLID185      1.656   0.000106
 Time at end of element matrix formulation CP = 168.421875.              

 DISTRIBUTED SPARSE MATRIX DIRECT SOLVER.
  Number of equations =       52680,    Maximum wavefront =     63

  Local memory allocated for solver              =     56.273 MB
  Local memory required for in-core solution     =     53.773 MB
  Local memory required for out-of-core solution =     23.006 MB

  Total memory allocated for solver              =    522.235 MB
  Total memory required for in-core solution     =    499.246 MB
  Total memory required for out-of-core solution =    211.881 MB

 *** NOTE ***                            CP =     169.234   TIME= 23:19:38
 The Distributed Sparse Matrix Solver is currently running in the        
 in-core memory mode.  This memory mode uses the most amount of memory   
 in order to avoid using the hard drive as much as possible, which most  
 often results in the fastest solution time.  This mode is recommended   
 if enough physical memory is present to accommodate all of the solver   
 data.                                                                   
 Distributed sparse solver maximum pivot= 19308099.3 at node 16177 UZ.   
 Distributed sparse solver minimum pivot= 1155155.48 at node 26 UY.      
 Distributed sparse solver minimum pivot in absolute value= 1155155.48   
 at node 26 UY.                                                          

   *** ELEMENT RESULT CALCULATION TIMES
     TYPE    NUMBER   ENAME      TOTAL CP  AVE CP

        1     15625  SOLID185      1.422   0.000091

   *** NODAL LOAD CALCULATION TIMES
     TYPE    NUMBER   ENAME      TOTAL CP  AVE CP

        1     15625  SOLID185      0.156   0.000010
 *** LOAD STEP     1   SUBSTEP     1  COMPLETED.    CUM ITER =      1
 *** TIME =   1.00000         TIME INC =   1.00000      NEW TRIANG MATRIX


 *** ANSYS BINARY FILE STATISTICS
  BUFFER SIZE USED= 16384
        1.875 MB WRITTEN ON ASSEMBLED MATRIX FILE: beso_2020_0.full
        1.688 MB WRITTEN ON RESULTS FILE: beso_2020_0.rst

 FINISH SOLUTION PROCESSING


 ***** ROUTINE COMPLETED *****  CP =       170.094



 *** ANSYS - ENGINEERING ANALYSIS SYSTEM  RELEASE 2019 R2          19.4     ***
 DISTRIBUTED ANSYS Mechanical Enterprise                       

 20120530  VERSION=WINDOWS x64   23:19:39  JAN 11, 2026 CP=    170.094

  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.mm)    



          ***** ANSYS RESULTS INTERPRETATION (POST1) *****

 *** NOTE ***                            CP =     170.094   TIME= 23:19:39
 Reading results into the database (SET command) will update the current 
 displacement and force boundary conditions in the database with the     
 values from the results file for that load set.  Note that any          
 subsequent solutions will use these values unless action is taken to    
 either SAVE the current values or not overwrite them (/EXIT,NOSAVE).    


 USE LOAD STEP     1  SUBSTEP  LAST    FOR LOAD CASE 0 

 SET COMMAND GOT LOAD STEP=     1  SUBSTEP=     1  CUMULATIVE ITERATION=     1
   TIME/FREQUENCY=  1.0000    
 TITLE=  Initial Mesh -- BESO Topology Optimization with Augmented Lagrange (N.m

 STORE SENE_TAB FROM ITEM=SENE  FOR ALL SELECTED ELEMENTS

 SUM ALL THE ACTIVE ENTRIES IN THE ELEMENT TABLE 

 TABLE LABEL     TOTAL
 SENE_TAB  0.359036E+07

 *GET  TOTALSENE  FROM  SSUM  ITEM=ITEM SENE_TAB  VALUE=  3590356.34    

 PARAMETER COMPLIANCE(ITER) =     7180712.685    

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 VECTOR GET OPERATION  sensit_C(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  ETAB  SENE_TAB

 STORE SEQV_TAB FROM ITEM=S    COMP=EQV   FOR ALL SELECTED ELEMENTS

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 VECTOR GET OPERATION  elemStress(1)  VECTOR LENGTH=   15625
 NAME= ELEM         1  ETAB  SEQV_TAB

 VECTOR PARAMETER OPERATION *VSCFUN 
  MAXSTRESS = MAX  elemStress(1)   
 VECTOR LENGTH=   15625
 RESULT=  617.56    

 PARAMETER MAXSTRESSHISTORY(ITER) =     617.5565142    

 PARAMETER SUM_PNORM_STRESS =     0.000000000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15625.     BY  1.0000    

 *IF  elemStress(i)                     ( =   32.6259     )  GT  
      1E-6                              ( =  0.100000E-05 )  THEN    

 PARAMETER RATIO_S =    0.7768064488E-01

 PARAMETER SUM_PNORM_STRESS =    0.1325874989E-08

 *ENDIF

 *ENDDO  INDEX= I                               

 *** WARNING ***                         CP =     172.656   TIME= 23:19:39
 * no longer valid as comment character - please use !                   
  *SET,stress_pnorm, sigma_ref * (sum_pnorm_stress**(1/p_norm_str        
  This warning only issued once.                                         

 PARAMETER STRESS_PNORM =     420.0000000    

 PARAMETER STRESSPNORMHISTORY(ITER) =     420.0000000    

 PARAMETER STRESS_ERROR =   -0.3199003001    

 PARAMETER PNORMERRORSTRESS(ITER) =   -0.3199003001    

 PARAMETER G_STRESS =     0.000000000    

 PARAMETER G_STRESSHISTORY(ITER) =     0.000000000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15625.     BY  1.0000    

 *IF  elemStress(i)                     ( =   32.6259     )  GT  
      1E-6                              ( =  0.100000E-05 )  THEN    

 PARAMETER RATIO_STRESS =    0.7768064488E-01

 PARAMETER POWER_TERM_S =    0.1706827990E-07

 PARAMETER NORM_TERM_S =     1.000000000    

 PARAMETER DSTRESS_DX =     32.62587085    

 PARAMETER SENSIT_G_STRESS(I) =    0.1706827990E-07

 *IF  xe(i)                             ( =   1.00000     )  LT  
      0.5                               ( =  0.500000     )  THEN    

 *ENDIF

 *ELSE

 *ENDIF

 *ENDDO  INDEX= I                               

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 VECTOR GET OPERATION  nodeDispX(1)  VECTOR LENGTH=   17576
 NAME= NODE         1  U     X   

 VECTOR GET OPERATION  nodeDispY(1)  VECTOR LENGTH=   17576
 NAME= NODE         1  U     Y   

 VECTOR GET OPERATION  nodeDispZ(1)  VECTOR LENGTH=   17576
 NAME= NODE         1  U     Z   

 SELECT      COMPONENT FIXED_BC                        

 *GET  NUMBCNODES  FROM  NODE  ITEM=COUN       VALUE=  16.0000000     

 *IF  numBCNodes                        ( =   16.0000     )  GT  
      0                                 ( =   0.00000     )  THEN    

 VECTOR FILL OPERATION  *VFILL  
  isBCNode(1)      = RAMP
 VECTOR LENGTH=   17576
 INITIAL VALUE=  0.0000      STEP INCREMENT=  0.0000    

 *GET  BCNODE    FROM  NODE  ITEM=NUM  MIN   VALUE=  4398.00000     

 *DO LOOP ON PARAMETER= II FROM  1.0000     TO  16.000     BY  1.0000    

 PARAMETER ISBCNODE(BCNODE) =     1.000000000    

 *IF  ii                                ( =   1.00000     )  LT  
      numBCNodes                        ( =   16.0000     )  THEN    

 *GET  BCNODE    FROM  NODE      4398  ITEM=NXTH       VALUE=  4399.00000     

 *ENDIF

 *ENDDO  INDEX= II                              

 *ENDIF

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 *GET  FIRSTNODE  FROM  NODE  ITEM=NUM  MIN   VALUE=  1.00000000     

 PARAMETER NODEID =     1.000000000    

 PARAMETER MAXDISPL =     0.000000000    

 *DO LOOP ON PARAMETER= II FROM  1.0000     TO  17576.     BY  1.0000    

 *IF  numBCNodes                        ( =   16.0000     )  GT  
      0                                 ( =   0.00000     )  THEN    

 *IF  isBCNode(nodeID)                  ( =   0.00000     )  EQ  
      0                                 ( =   0.00000     )  THEN    

 PARAMETER UX =   -0.4248062411E-01

 PARAMETER UY =   -0.4248062411E-01

 PARAMETER UZ =   -0.3273468245    

 PARAMETER NODEDISPLMAG(NODEID) =    0.3328139876    

 *IF  nodeDisplMag(nodeID)              ( =  0.332814     )  GT  
      maxDispl                          ( =   0.00000     )  THEN    

 PARAMETER MAXDISPL =    0.3328139876    

 *ENDIF

 *ELSE

 *ENDIF

 *ELSE

 *ENDIF

 *IF  ii                                ( =   1.00000     )  LT  
      numNode                           ( =   17576.0     )  THEN    

 *GET  NODEID    FROM  NODE         1  ITEM=NXTH       VALUE=  2.00000000     

 *ENDIF

 *ENDDO  INDEX= II                              

 PARAMETER MAXDISPLHISTORY(ITER) =    0.7455009135    

 PARAMETER SUM_PNORM_DISPL =     0.000000000    

 *GET  FIRSTNODE  FROM  NODE  ITEM=NUM  MIN   VALUE=  1.00000000     

 PARAMETER NODEID =     1.000000000    

 *DO LOOP ON PARAMETER= II FROM  1.0000     TO  17576.     BY  1.0000    

 *IF  nodeDisplMag(nodeID)              ( =  0.332814     )  GT  
      1E-12                             ( =  0.100000E-11 )  THEN    

 PARAMETER RATIO_D =    0.6656279752E-02

 PARAMETER SUM_PNORM_DISPL =    0.8697399074E-13

 *ENDIF

 *IF  ii                                ( =   1.00000     )  LT  
      numNode                           ( =   17576.0     )  THEN    

 *GET  NODEID    FROM  NODE         1  ITEM=NXTH       VALUE=  2.00000000     

 *ENDIF

 *ENDDO  INDEX= II                              

 PARAMETER DISPL_PNORM =     50.00000000    

 PARAMETER DISPLPNORMHISTORY(ITER) =     50.00000000    

 PARAMETER DISPL_ERROR =     66.06899897    

 PARAMETER PNORMERRORDISPL(ITER) =     66.06899897    

 PARAMETER G_DISPL =     0.000000000    

 PARAMETER G_DISPLHISTORY(ITER) =     0.000000000    
  ========================================
  Iter 1 Analysis:
  Compliance = 7180712.68
  Max Stress = 617.556514 MPa, P-norm = 420 MPa (Error: -0.3199003 pct)
  Max Displ = 0.745500914 mm, P-norm = 50 mm (Error: 66.068999 pct)
  g_stress = 0 pct, g_displ = 0 pct
  ========================================

 VECTOR FILL OPERATION  *VFILL  
  sensit_g_displ(1 = RAMP
 VECTOR LENGTH=   15625
 INITIAL VALUE=  0.0000      STEP INCREMENT=  0.0000    

 *DO LOOP ON PARAMETER= I FROM  1.0000     TO  15625.     BY  1.0000    

 SELECT       FOR ITEM=ELEM COMPONENT=    
  IN RANGE         1 TO          1 STEP          1

          1  ELEMENTS (OF      15625  DEFINED) SELECTED BY  ESEL  COMMAND.

 SELECT      ALL NODES HAVING ANY ELEMENT IN ELEMENT SET.

          8 NODES (OF      17576  DEFINED) SELECTED FROM
        1 SELECTED ELEMENTS BY NSLE COMMAND.

 *GET  NUMELEMNODES  FROM  NODE  ITEM=COUN       VALUE=  8.00000000     

 *IF  numElemNodes                      ( =   8.00000     )  GT  
      0                                 ( =   0.00000     )  THEN    

 *GET  ELEMNODE  FROM  NODE  ITEM=NUM  MIN   VALUE=  153.000000     

 PARAMETER ELEM_DISPL_SENSIT =     0.000000000    

 *DO LOOP ON PARAMETER= JJ FROM  1.0000     TO  8.0000     BY  1.0000    

 *IF  nodeDisplMag(elemNode)            ( =  0.457122     )  GT  
      1E-12                             ( =  0.100000E-11 )  THEN    

 PARAMETER RATIO_NODE =    0.9142446841E-02

 PARAMETER POWER_TERM_D =    0.6387225056E-10

 PARAMETER NORM_TERM_D =     1.000000000    

 PARAMETER DDISPL_DX =     118.8598938    

 PARAMETER ELEM_DISPL_SENSIT =    0.7591848918E-08

 *ENDIF

 *IF  jj                                ( =   1.00000     )  LT  
      numElemNodes                      ( =   8.00000     )  THEN    

 *GET  ELEMNODE  FROM  NODE       153  ITEM=NXTH       VALUE=  154.000000     

 *ENDIF

 *ENDDO  INDEX= JJ                              

 PARAMETER SENSIT_G_DISPL(I) =    0.1533915991E-09

 *IF  xe(i)                             ( =   1.00000     )  LT  
      0.5                               ( =  0.500000     )  THEN    

 *ENDIF

 *ENDIF

 SELECT ALL ENTITIES OF TYPE= ALL  AND BELOW

 *ENDDO  INDEX= I                               
